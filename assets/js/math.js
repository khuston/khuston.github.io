var arb1,arb2,onePi,twoPi,halfPi,ln10,defaultDecimals=18,pi=Math.PI,eulerGamma=.5772156649015329,constants={decimals:50,precisionScale:10n**50n,e:271828182845904523536028747135266249775724709369995n,eulerGamma:57721566490153286060651209008240243104215933593992n,ln10:230258509299404568401799145468436420760110148862877n,pi:314159265358979323846264338327950288419716939937510n};function getConstant(a){return constants[a]*precisionScale/constants.precisionScale}bernoulli2nN=[1n,1n,-1n,1n,-1n,5n,-691n,7n,-3617n,43867n,-174611n,854513n,-236364091n,8553103n,-23749461029n,8615841276005n,-7709321041217n,2577687858367n,-26315271553053477373n,2929993913841559n,-261082718496449122051n,1520097643918070802691n,-27833269579301024235023n,596451111593912163277961n,-5609403368997817686249127547n,495057205241079648212477525n,-801165718135489957347924991853n,29149963634884862421418123812691n,-2479392929313226753685415739663229n,84483613348880041862046775994036021n,-1215233140483755572040304994079820246041491n,12300585434086858541953039857403386151n,-106783830147866529886385444979142647942017n,1472600022126335654051619428551932342241899101n,-78773130858718728141909149208474606244347001n,1505381347333367003803076567377857208511438160235n,-5827954961669944110438277244641067365282488301844260429n,34152417289221168014330073731472635186688307783087n,-24655088825935372707687196040585199904365267828865801n,414846365575400828295179035549542073492199375372400483487n,-4603784299479457646935574969019046849794257872751288919656867n,1677014149185145836823154509786269900207736027570253414881613n,-2024576195935290360231131160111731009989917391198090877281083932477n,660714619417678653573847847426261496277830686653388931761996983n,-1311426488674017507995511424019311843345750275572028644296919890574047n,1179057279021082799884123351249215083775254949669647116231545215727922535n,-1295585948207537527989427828538576749659341483719435143023316326829946247n,1220813806579744469607301679413201203958508415202696621436215105284649447n,-211600449597266513097597728109824233673043954389060234150638733420050668349987259n,67908260672905495624051117546403605607342195728504487509073961249992947058239n,-94598037819122125295227433069493721872702841533066936133385696204311395415197247711n],bernoulli2nD=[1n,6n,30n,42n,30n,66n,2730n,6n,510n,798n,330n,138n,2730n,6n,870n,14322n,510n,6n,1919190n,6n,13530n,1806n,690n,282n,46410n,66n,1590n,798n,870n,354n,56786730n,6n,510n,64722n,30n,4686n,140100870n,6n,30n,3318n,230010n,498n,3404310n,6n,61410n,272118n,1410n,6n,4501770n,6n,33330n];var factorialCache=[1,1,2,6,24,120,720,5040,40320,362880,3628800];function complex(b,a=0){return 0===a&&isArbitrary(b)&&(a=0n),{re:b,im:a}}var C=complex;function isComplex(a){return"object"==typeof a&&"re"in a}var precisionScale,decimals=[];function setPrecisionScale(a){"reset"===a?decimals.shift():decimals.unshift(a),precisionScale=10n**BigInt(decimals[0]),arb2=2n*(arb1=arbitrary(1)),twoPi=2n*(onePi=getConstant("pi")),halfPi=onePi/2n,ln10=getConstant("ln10")}function resetPrecisionScale(){setPrecisionScale("reset")}function arbitrary(a){if(isComplex(a))return{re:arbitrary(a.re),im:arbitrary(a.im)};if(isArbitrary(a))return Number(a)/10**decimals[0];var c=a.toExponential().split("e"),b=c[0].replace(".",""),e=b.length-("-"===b[0]?2:1),d=+c[1]+decimals[0]-e;return d<0?BigInt(Math.round(a*10**decimals[0])):BigInt(b+"0".repeat(d))}setPrecisionScale(defaultDecimals);var A=arbitrary;function isArbitrary(a){return"bigint"==typeof a||"bigint"==typeof a.re}function isZero(a){return isComplex(a)?0===a.re&&0===a.im:0===a}function isUnity(a){return isComplex(a)?1===a.re&&0===a.im:1===a}function isReal(a){return!isComplex(a)||0===a.im}function isInteger(a){return isComplex(a)?Number.isInteger(a.re)&&0===a.im:Number.isInteger(a)}function isPositiveInteger(a){return isComplex(a)?Number.isInteger(a.re)&&a.re>0&&0===a.im:Number.isInteger(a)&&a>0}function isPositiveIntegerOrZero(a){return isComplex(a)?Number.isInteger(a.re)&&a.re>=0&&0===a.im:Number.isInteger(a)&&a>=0}function isNegativeInteger(a){return isComplex(a)?Number.isInteger(a.re)&&a.re<0&&0===a.im:Number.isInteger(a)&&a<0}function isNegativeIntegerOrZero(a){return isComplex(a)?Number.isInteger(a.re)&&a.re<=0&&0===a.im:Number.isInteger(a)&&a<=0}function isEqualTo(a,b){return isComplex(a)||isComplex(b)?(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),a.re===b.re&&a.im===b.im):a===b}function re(a){return isComplex(a)?a.re:a}var real=re;function im(a){return isComplex(a)?a.im:0}var imag=im;function abs(a){return isComplex(a)?isArbitrary(a)?0n===a.im?abs(a.re):0n===a.re?abs(a.im):abs(a.re)<abs(a.im)?mul(abs(a.im),sqrt(arb1+div(div(mul(a.re,a.re),a.im),a.im))):mul(abs(a.re),sqrt(arb1+div(div(mul(a.im,a.im),a.re),a.re))):0===a.im?Math.abs(a.re):0===a.re?Math.abs(a.im):Math.abs(a.re)<Math.abs(a.im)?Math.abs(a.im)*Math.sqrt(1+(a.re/a.im)**2):Math.abs(a.re)*Math.sqrt(1+(a.im/a.re)**2):isArbitrary(a)?a<0n?-a:a:Math.abs(a)}function arg(a){return isComplex(a)?Math.atan2(a.im+0,a.re+0):Math.atan2(0,a+0)}function add(a,b){if(arguments.length>2){for(var c=add(a,b),d=2;d<arguments.length;d++)c=add(c,arguments[d]);return c}return isComplex(a)||isComplex(b)?(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),{re:a.re+b.re,im:a.im+b.im}):a+b}function sub(a,b){return isComplex(a)||isComplex(b)?(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),{re:a.re-b.re,im:a.im-b.im}):a-b}function mul(a,b){if(arguments.length>2){for(var c=mul(a,b),d=2;d<arguments.length;d++)c=mul(c,arguments[d]);return c}return isComplex(a)||isComplex(b)?(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),isArbitrary(a))?{re:(a.re*b.re-a.im*b.im)/precisionScale,im:(a.im*b.re+a.re*b.im)/precisionScale}:{re:a.re*b.re-a.im*b.im,im:a.im*b.re+a.re*b.im}:isArbitrary(a)?a*b/precisionScale:a*b}function neg(a){return isComplex(a)?{re:-a.re,im:-a.im}:-a}function div(b,a){if(isComplex(b)||isComplex(a)){if(isComplex(b)||(b=complex(b)),isComplex(a)||(a=complex(a)),0===a.re&&0===a.im||0n===a.re&&0n===a.im)throw Error("Division by zero");if(isArbitrary(b)){var d={re:b.re*a.re+b.im*a.im,im:b.im*a.re-b.re*a.im},e=a.re*a.re+a.im*a.im;return{re:precisionScale*d.re/e,im:precisionScale*d.im/e}}if(Math.abs(a.re)<Math.abs(a.im)){var c=a.re/a.im;return{re:(b.re*c+b.im)/(a.re*c+a.im),im:(b.im*c-b.re)/(a.re*c+a.im)}}var c=a.im/a.re;return{re:(b.re+b.im*c)/(a.re+a.im*c),im:(b.im-b.re*c)/(a.re+a.im*c)}}if(0===a||0n===a)throw Error("Division by zero");return isArbitrary(b)?precisionScale*b/a:b/a}function inv(a){return isArbitrary(a)?div(arb1,a):div(1,a)}function pow(a,b){if(isArbitrary(a)||isArbitrary(b))return isArbitrary(a)||(a=arbitrary(a)),isArbitrary(b)||(b=arbitrary(b)),exp(mul(b,ln(a)));if(isComplex(a)||isComplex(b)){if(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),0===a.re&&0===a.im&&b.re>0)return complex(0);if(0===a.re&&0===a.im&&0===b.re&&0===b.im)return complex(1);if(0===a.re&&0===a.im&&b.re<0)throw Error("Power singularity");return exp(mul(b,log(a)))}if(0===a&&b<0)throw Error("Power singularity");return a<0&&!Number.isInteger(b)?pow(complex(a),b):a**b}function root(a,b){return pow(a,div(1,b))}function surd(a,b){if(isComplex(a)||isComplex(b))throw Error("Surd requires real inputs");if(!isInteger(b))throw Error("Second parameter of surd must be integer");if(1&b){var c=Math.sign(a);return c*root(c*a,b)}if(a<0)throw Error("First parameter of surd must be positive for even integers");return root(a,b)}function sqrt(a){if(isComplex(a)){if(isArbitrary(a)){if(0n===a.im)return a.re<0n?{re:0n,im:sqrt(-a.re)}:{re:sqrt(a.re),im:0n};var d=abs(a),f=a.im<0n?-1n:1n;return{re:sqrt(div(d+a.re,arb2)),im:f*sqrt(div(d-a.re,arb2))}}return 0===a.im?a.re<0?{re:0,im:Math.sqrt(-a.re)}:{re:Math.sqrt(a.re),im:0}:exp(mul(.5,log(a)))}if(isArbitrary(a)){if(0n===a)return0n;if(a<0n)throw Error("Cannot evaluate real square root of "+a);for(var b,e,c=a;c!==b;)e=(b=c)+div(a,b),c=div(e,arb2);return b}return a<0?{re:0,im:Math.sqrt(-a)}:Math.sqrt(a)}function complexAverage(a,b,c=1e-5){return div(add(a(add(b,c)),a(sub(b,c))),2)}function complexFromString(a,e=!1){var c,b,d="";return(("+"===a[0]||"-"===a[0])&&(d=a[0],a=a.slice(1)),a.includes("+")||a.includes("-")?a.includes("+")?(c=d+a.slice(0,a.indexOf("+")),b=a.slice(a.indexOf("+")+1,a.length-1)):(c=d+a.slice(0,a.indexOf("-")),b=a.slice(a.indexOf("-"),a.length-1)):a.includes("i")?(c="0",b=d+a.slice(0,a.length-1)):(c=d+a,b="0"),(""===b||"-"===b)&&(b+="1"),e)?`{ re: ${c}, im: ${b} }`:{re:+c,im:+b}}function output(){for(var a=0;a<arguments.length;a++)console.log(arguments[a])}function besselJ(a,b){if(isComplex(a)||isComplex(b)){if(isNegativeInteger(a))return mul(pow(-1,a),besselJ(neg(a),b));var c=div(pow(div(b,2),a),gamma(add(a,1)));return mul(c,hypergeometric0F1(add(a,1),mul(-0.25,pow(b,2))))}return isNegativeInteger(a)?(-1)**a*besselJ(-a,b):!Number.isInteger(a)&&b<0?besselJ(a,complex(b)):(b/2)**a*hypergeometric0F1(a+1,-0.25*b**2)/gamma(a+1)}function besselJZero(a,c,g=!1){if(isComplex(a)||isComplex(c))throw Error("Complex arguments not supported in Bessel zero");if(!isPositiveInteger(c))throw Error("Unsupported index for Bessel zero");var d=pi/4;if(g){if(0===a&&1===c)return 0;var e=(c+Math.abs(a)/2-3/4)*pi,b=e-(4*a**2+3)/(8*e);if(a<0)throw Error("Negative order for Bessel derivative zero not supported");return findRoot(b=>diff(b=>besselJ(a,b),b),[b-d<0?0:b-d,b+d])}var f=(c+Math.abs(a)/2-1/4)*pi,b=f-(4*a**2-1)/(8*f);return a<0&&(b+=fractionalPart(a)*pi),findRoot(b=>besselJ(a,b),[1===c?1e-10:b-d,b+d])}function besselY(a,b){if(isComplex(a)||isComplex(b)){if(isZero(b)&&(isComplex(a)||(a=complex(a)),-0.5===fractionalPart(a.re)&&0===a.im))return complex(0);if(isInteger(a))return div(add(diff(a=>besselJ(a,b),a),mul(pow(-1,a),diff(a=>besselJ(a,b),neg(a)))),pi);var c=sub(mul(besselJ(a,b),cos(mul(a,pi))),besselJ(neg(a),b));return div(c,sin(mul(a,pi)))}return b<0?besselY(a,complex(b)):0===b&& -0.5===fractionalPart(a)?0:Number.isInteger(a)?(diff(a=>besselJ(a,b),a)+(-1)**a*diff(a=>besselJ(a,b),-a))/pi:(besselJ(a,b)*cos(a*pi)-besselJ(-a,b))/sin(a*pi)}function besselYZero(a,c,g=!1){if(isComplex(a)||isComplex(c))throw Error("Complex arguments not supported in Bessel zero");if(!isPositiveInteger(c))throw Error("Unsupported index for Bessel zero");var d=pi/4;if(g){var e=(c+Math.abs(a)/2-1/4)*pi,b=e-(4*a**2+3)/(8*e);if(a<0)throw Error("Negative order for Bessel derivative zero not supported");return findRoot(b=>diff(b=>besselY(a,b),b),[b-d,b+d])}var f=(c+Math.abs(a)/2-3/4)*pi,b=f-(4*a**2-1)/(8*f);return a<0&&(fractionalPart(a)> -0.5?b+=fractionalPart(a)*pi:b+=(1+fractionalPart(a))*pi),findRoot(b=>besselY(a,b),[1===c&&fractionalPart(a)> -0.5?1e-10:b-d,b+d])}function besselI(a,b){if(isComplex(a)||isComplex(b)){if(isNegativeInteger(a))return besselI(neg(a),b);var c=div(pow(div(b,2),a),gamma(add(a,1)));return mul(c,hypergeometric0F1(add(a,1),mul(.25,pow(b,2))))}return isNegativeInteger(a)?besselI(-a,b):!Number.isInteger(a)&&b<0?besselI(a,complex(b)):(b/2)**a*hypergeometric0F1(a+1,.25*b**2)/gamma(a+1)}function besselK(a,b){if(isComplex(a)||isComplex(b)){if(abs(b)>10){var c=mul(sqrt(div(pi/2,b)),exp(neg(b))),d=hypergeometric2F0(add(a,.5),sub(.5,a),div(-0.5,b));return mul(c,d)}if(isInteger(a))return mul(pow(-1,add(a,1)),.5,add(diff(a=>besselI(a,b),a),diff(a=>besselI(a,b),neg(a))));var e=div(pi/2,sin(mul(a,pi)));return mul(e,sub(besselI(neg(a),b),besselI(a,b)))}return b>10?sqrt(pi/2/b)*exp(-b)*hypergeometric2F0(a+.5,.5-a,-0.5/b):b<0?besselK(a,complex(b)):Number.isInteger(a)?(-1)**(a+1)/2*(diff(a=>besselI(a,b),a)+diff(a=>besselI(a,b),-a)):pi/2*(besselI(-a,b)-besselI(a,b))/sin(a*pi)}function hankel1(a,b){return add(besselJ(a,b),mul(complex(0,1),besselY(a,b)))}function hankel2(a,b){return sub(besselJ(a,b),mul(complex(0,1),besselY(a,b)))}function airyAi(a){if(isComplex(a)){if(isZero(a))return complex(1/3**(2/3)/gamma(2/3));if(a.re<0){var b=mul(2/3,pow(neg(a),1.5));return mul(1/3,sqrt(neg(a)),add(besselJ(1/3,b),besselJ(-1/3,b)))}var b=mul(2/3,pow(a,1.5));return mul(1/pi,sqrt(div(a,3)),besselK(1/3,b))}if(0===a)return 1/3**(2/3)/gamma(2/3);if(a<0){var b=2/3*(-a)**1.5;return sqrt(-a)/3*(besselJ(1/3,b)+besselJ(-1/3,b))}var b=2/3*a**1.5;return 1/pi*sqrt(a/3)*besselK(1/3,b)}function airyAiPrime(a){if(isComplex(a)){if(isZero(a))return complex(-1/3**(1/3)/gamma(1/3));if(a.re<0){var b=mul(2/3,pow(neg(a),1.5));return mul(1/3,a,sub(besselJ(-2/3,b),besselJ(2/3,b)))}var b=mul(2/3,pow(a,1.5));return mul(-1/pi/sqrt(3),a,besselK(2/3,b))}if(0===a)return -1/3**(1/3)/gamma(1/3);if(a<0){var b=2/3*(-a)**1.5;return a/3*(besselJ(-2/3,b)-besselJ(2/3,b))}var b=2/3*a**1.5;return -1/pi/sqrt(3)*a*besselK(2/3,b)}function airyBi(a){if(isComplex(a)){if(isZero(a))return complex(1/3**(1/6)/gamma(2/3));if(a.re<0){var b=mul(2/3,pow(neg(a),1.5));return mul(sqrt(div(neg(a),3)),sub(besselJ(-1/3,b),besselJ(1/3,b)))}var b=mul(2/3,pow(a,1.5));return mul(sqrt(div(a,3)),add(besselI(1/3,b),besselI(-1/3,b)))}if(0===a)return 1/3**(1/6)/gamma(2/3);if(a<0){var b=2/3*(-a)**1.5;return sqrt(-a/3)*(besselJ(-1/3,b)-besselJ(1/3,b))}var b=2/3*a**1.5;return sqrt(a/3)*(besselI(1/3,b)+besselI(-1/3,b))}function airyBiPrime(a){if(isComplex(a)){if(isZero(a))return complex(3**(1/6)/gamma(1/3));if(a.re<0){var b=mul(2/3,pow(neg(a),1.5));return mul(1/sqrt(3),neg(a),add(besselJ(2/3,b),besselJ(-2/3,b)))}var b=mul(2/3,pow(a,1.5));return mul(1/sqrt(3),a,add(besselI(2/3,b),besselI(-2/3,b)))}if(0===a)return 3**(1/6)/gamma(1/3);if(a<0){var b=2/3*(-a)**1.5;return-a/sqrt(3)*(besselJ(2/3,b)+besselJ(-2/3,b))}var b=2/3*a**1.5;return a/sqrt(3)*(besselI(2/3,b)+besselI(-2/3,b))}function sphericalBesselJ(b,a){return mul(div(sqrt(pi/2),sqrt(a)),besselJ(add(b,.5),a))}function sphericalBesselY(b,a){return mul(div(sqrt(pi/2),sqrt(a)),besselY(add(b,.5),a))}function sphericalHankel1(a,b){return add(sphericalBesselJ(a,b),mul(complex(0,1),sphericalBesselY(a,b)))}function sphericalHankel2(a,b){return sub(sphericalBesselJ(a,b),mul(complex(0,1),sphericalBesselY(a,b)))}function struveH(a,b){return mul(pow(b,add(a,1)),inv(mul(pow(2,a),sqrt(pi),gamma(add(a,1.5)))),hypergeometric1F2(1,1.5,add(a,1.5),mul(-1/4,pow(b,2))))}function struveL(a,b){return mul(pow(b,add(a,1)),inv(mul(pow(2,a),sqrt(pi),gamma(add(a,1.5)))),hypergeometric1F2(1,1.5,add(a,1.5),mul(1/4,pow(b,2))))}function jacobiTheta(g,d,e,f=1e-10){if(abs(e)>=1)throw Error("Unsupported elliptic nome");if(![1,2,3,4].includes(g))throw Error("Undefined Jacobi theta index");if(isComplex(d)||isComplex(e)){isComplex(d)||(d=complex(d));var k=div(log(e),complex(0,1));if(Math.abs(d.im)>Math.abs(k.im)||Math.abs(d.re)>Math.PI){var h=Math.floor(d.im/k.im),b=Math.floor((d=sub(d,mul(h,k))).re/Math.PI);d=sub(d,b*Math.PI);var i=pow(e,-h*h),j=exp(mul(-2*h,d,complex(0,1)));switch(g){case 1:return mul((-1)**(b+h),i,j,chop(jacobiTheta(g,d,e),f));case 2:return mul((-1)**b,i,j,chop(jacobiTheta(g,d,e),f));case 3:return mul(i,j,chop(jacobiTheta(g,d,e),f));case 4:return mul((-1)**h,i,j,chop(jacobiTheta(g,d,e),f))}}switch(g){case 1:for(var c=complex(0),b=complex(1),a=0;Math.abs(b.re)>f||Math.abs(b.im)>f;)b=mul((-1)**a,pow(e,a*a+a),sin(mul(2*a+1,d))),c=add(c,b),a++;return mul(2,pow(e,1/4),c);case 2:for(var c=complex(0),b=complex(1),a=0;Math.abs(b.re)>f||Math.abs(b.im)>f;)b=mul(pow(e,a*a+a),cos(mul(2*a+1,d))),c=add(c,b),a++;return mul(2,pow(e,1/4),c);case 3:for(var c=complex(0),b=complex(1),a=1;Math.abs(b.re)>f||Math.abs(b.im)>f;)b=mul(pow(e,a*a),cos(mul(2*a,d))),c=add(c,b),a++;return add(1,mul(2,c));case 4:for(var c=complex(0),b=complex(1),a=1;Math.abs(b.re)>f||Math.abs(b.im)>f;)b=mul(pow(neg(e),a*a),cos(mul(2*a,d))),c=add(c,b),a++;return add(1,mul(2,c))}}else switch(g){case 1:if(e<0)return jacobiTheta(g,d,complex(e));for(var c=0,b=1,a=0;Math.abs(b)>f;)b=(-1)**a*e**(a*a+a)*sin((2*a+1)*d),c+=b,a++;return 2*e**(1/4)*c;case 2:if(e<0)return jacobiTheta(g,d,complex(e));for(var c=0,b=1,a=0;Math.abs(b)>f;)b=e**(a*a+a)*cos((2*a+1)*d),c+=b,a++;return 2*e**(1/4)*c;case 3:for(var c=0,b=1,a=1;Math.abs(b)>f;)b=e**(a*a)*cos(2*a*d),c+=b,a++;return 1+2*c;case 4:for(var c=0,b=1,a=1;Math.abs(b)>f;)b=(-e)**(a*a)*cos(2*a*d),c+=b,a++;return 1+2*c}}function ellipticNome(a){return isComplex(a)?exp(div(mul(-pi,ellipticK(sub(1,a))),ellipticK(a))):a>1?ellipticNome(complex(a)):a<0?-exp(-pi*ellipticK(1/(1-a))/ellipticK(a/(a-1))):exp(-pi*ellipticK(1-a)/ellipticK(a))}function fundamentalParallelogram(c,a,b){var d=(c.re*b.im-c.im*b.re)/(a.re*b.im-a.im*b.re),e=(c.im*a.re-c.re*a.im)/(a.re*b.im-a.im*b.re);return add(c,mul(-Math.floor(d),a),mul(-Math.floor(e),b))}function sn(c,a){if(a>1||isComplex(c)||isComplex(a)){if(isComplex(a)||(a=complex(a)),abs(a)>1)return mul(inv(sqrt(a)),sn(mul(sqrt(a),c),inv(a)));var e=mul(4,ellipticK(a)),f=mul(complex(0,2),ellipticK(sub(1,a)));c=fundamentalParallelogram(c,e,f);var b=ellipticNome(a),d=div(c,pow(jacobiTheta(3,0,b),2));return mul(div(jacobiTheta(3,0,b),jacobiTheta(2,0,b)),div(jacobiTheta(1,d,b),jacobiTheta(4,d,b)))}if(0===a)return sin(c);if(1===a)return tanh(c);var b=ellipticNome(a),d=c/jacobiTheta(3,0,b)**2;return a<0?jacobiTheta(3,0,b)/jacobiTheta(4,d,b)*div(jacobiTheta(1,d,b),jacobiTheta(2,0,b)).re:jacobiTheta(3,0,b)/jacobiTheta(2,0,b)*jacobiTheta(1,d,b)/jacobiTheta(4,d,b)}function cn(c,a){if(a>1||isComplex(c)||isComplex(a)){if(isComplex(a)||(a=complex(a)),abs(a)>1)return dn(mul(sqrt(a),c),inv(a));var e=mul(4,ellipticK(a)),f=add(div(e,2),mul(complex(0,2),ellipticK(sub(1,a))));c=fundamentalParallelogram(c,e,f);var b=ellipticNome(a),d=div(c,pow(jacobiTheta(3,0,b),2));return mul(div(jacobiTheta(4,0,b),jacobiTheta(2,0,b)),div(jacobiTheta(2,d,b),jacobiTheta(4,d,b)))}if(0===a)return cos(c);if(1===a)return sech(c);var b=ellipticNome(a),d=c/jacobiTheta(3,0,b)**2;return a<0?jacobiTheta(4,0,b)/jacobiTheta(4,d,b)*div(jacobiTheta(2,d,b),jacobiTheta(2,0,b)).re:jacobiTheta(4,0,b)/jacobiTheta(2,0,b)*jacobiTheta(2,d,b)/jacobiTheta(4,d,b)}function dn(c,a){if(a>1||isComplex(c)||isComplex(a)){if(isComplex(a)||(a=complex(a)),abs(a)>1)return cn(mul(sqrt(a),c),inv(a));var e=mul(2,ellipticK(a)),f=mul(complex(0,4),ellipticK(sub(1,a)));c=fundamentalParallelogram(c,e,f);var b=ellipticNome(a),d=div(c,pow(jacobiTheta(3,0,b),2));return mul(div(jacobiTheta(4,0,b),jacobiTheta(3,0,b)),div(jacobiTheta(3,d,b),jacobiTheta(4,d,b)))}if(0===a)return 1;if(1===a)return sech(c);var b=ellipticNome(a),d=c/jacobiTheta(3,0,b)**2;return jacobiTheta(4,0,b)/jacobiTheta(3,0,b)*jacobiTheta(3,d,b)/jacobiTheta(4,d,b)}function am(b,a){if(a>1||isComplex(b)||isComplex(a)){if(isComplex(b)||(b=complex(b)),isComplex(a)||(a=complex(a)),0===a.im&&a.re<=1){var d=ellipticK(a.re),c=Math.round(b.re/2/d);if(b=sub(b,2*c*d),a.re<0){var e=ellipticK(1-a.re);if(1&Math.round(b.im/2/e.re))return sub(c*pi,arcsin(sn(b,a)))}return add(arcsin(sn(b,a)),c*pi)}return arcsin(sn(b,a))}var d=ellipticK(a),c=Math.round(b/2/d);return Math.asin(sn(b-=2*c*d,a))+c*pi}function weierstrassRoots(a,b){function c(a,b,c){return mul(2/sqrt(3),sqrt(a),cos(sub(div(arccos(mul(3*sqrt(3)/2,b,pow(a,-1.5))),3),2*pi*c/3)))}a=div(a,4),b=div(b,4);var d=c(a,b,0),e=c(a,b,1),f=c(a,b,2);return[d,e,f]}function weierstrassHalfPeriods(e,f){var[b,g,a]=weierstrassRoots(e,f),c=sqrt(sub(b,a)),d=div(sub(g,a),sub(b,a)),h=div(ellipticK(d),c),i=div(mul(complex(0,1),ellipticK(sub(1,d))),c);return[h,i]}function weierstrassInvariants(a,b){isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),b.im/b.re<a.im/a.re&&([a,b]=[b,a]);var h,e=div(b,a);e.im<0&&(e.im=-e.im,h=!0);var i=exp(mul(complex(0,1),pi,e)),c=jacobiTheta(2,0,i),d=jacobiTheta(3,0,i),f=mul(4/3*pi**4,pow(mul(2,a),-4),add(pow(c,8),mul(-1,pow(c,4),pow(d,4)),pow(d,8))),g=mul(8/27*pi**6,pow(mul(2,a),-6),add(pow(c,12),mul(-1.5,pow(c,8),pow(d,4)),mul(-1.5,pow(c,4),pow(d,8)),pow(d,12)));return h&&(f.im=-f.im,g.im=-g.im),[f,g]}function weierstrassP(b,d,e){isComplex(b)||(b=complex(b));var[c,f,a]=weierstrassRoots(d,e),g=div(sub(f,a),sub(c,a));return add(a,mul(sub(c,a),pow(sn(mul(b,sqrt(sub(c,a))),g),-2)))}function weierstrassPPrime(a,f,g){isComplex(a)||(a=complex(a));var[c,h,b]=weierstrassRoots(f,g),d=div(sub(h,b),sub(c,b)),e=mul(a,sqrt(sub(c,b)));return mul(-2,pow(sub(c,b),1.5),cn(e,d),dn(e,d),pow(sn(e,d),-3))}function inverseWeierstrassP(a,b,c){isComplex(a)||(a=complex(a));var[d,e,f]=weierstrassRoots(b,c);return carlsonRF(sub(a,d),sub(a,e),sub(a,f))}function kleinJ(e){var a=exp(mul(complex(0,pi),e)),b=chop(jacobiTheta(2,0,a)),c=chop(jacobiTheta(3,0,a)),d=chop(jacobiTheta(4,0,a)),f=pow(add(pow(b,8),pow(c,8),pow(d,8)),3),g=mul(54,pow(mul(b,c,d),8));return div(f,g)}function carlsonRC(a,b){return a<0||b<0||isComplex(a)||isComplex(b)?(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),a.re===b.re&&a.im===b.im)?inv(sqrt(a)):div(arccos(div(sqrt(a),sqrt(b))),mul(sqrt(b),sqrt(sub(1,div(a,b))))):a===b?1/Math.sqrt(a):a<b?Math.acos(Math.sqrt(a/b))/Math.sqrt(b-a):Math.acosh(Math.sqrt(a/b))/Math.sqrt(a-b)}function carlsonRD(b,c,a){return carlsonRJ(b,c,a,a)}function carlsonRF(a,b,c,v=1e-10){if(isComplex(a)||isComplex(b)||isComplex(c)){for(var h=a,i=b,j=c,d=A0=div(add(a,b,c),3),t=Math.pow(3*v,-1/6)*Math.max(abs(sub(A0,a)),abs(sub(A0,b)),abs(sub(A0,c))),e=.25,k=1;;){var o=sqrt(h),p=sqrt(i),q=sqrt(j),f=add(mul(o,p),mul(o,q),mul(p,q)),u=mul(add(d,f),e);if(h=mul(add(h,f),e),i=mul(add(i,f),e),j=mul(add(j,f),e),k*t<abs(d))break;d=u,k*=e}var r=div(k,d),l=mul(sub(A0,a),r),m=mul(sub(A0,b),r),n=neg(add(l,m)),g=sub(mul(l,m),mul(n,n)),s=mul(l,m,n);return mul(pow(d,-0.5),add(9240,mul(-924,g),mul(385,g,g),mul(660,s),mul(-630,g,s)),1/9240)}if(b===c)return carlsonRC(a,b);if(a===c)return carlsonRC(b,a);if(a===b)return carlsonRC(c,a);if(a<0||b<0||c<0)return carlsonRF(complex(a),b,c);for(var h=a,i=b,j=c,d=A0=(a+b+c)/3,t=Math.pow(3*v,-1/6)*Math.max(Math.abs(A0-a),Math.abs(A0-b),Math.abs(A0-c)),e=.25,k=1;;){var o=Math.sqrt(h),p=Math.sqrt(i),q=Math.sqrt(j),f=o*p+o*q+p*q,u=(d+f)*e;if(h=(h+f)*e,i=(i+f)*e,j=(j+f)*e,k*t<Math.abs(d))break;d=u,k*=e}var r=k/d,l=(A0-a)*r,m=(A0-b)*r,n=-l-m,g=l*m-n**2,s=l*m*n;return Math.pow(d,-0.5)*(9240-924*g+385*g**2+660*s-630*g*s)/9240}function carlsonRG(b,c,a){var d=mul(a,carlsonRF(b,c,a)),e=mul(-1/3,sub(b,a),sub(c,a),carlsonRD(b,c,a)),f=sqrt(mul(b,c,inv(a)));return mul(.5,add(d,e,f))}function carlsonRJ(d,e,f,b,L=1e-10){if(isComplex(d)||isComplex(e)||isComplex(f)||isComplex(b)){for(var n=d,o=e,p=f,q=b,c=Am=div(add(d,e,f,mul(2,b)),5),z=mul(sub(b,d),sub(b,e),sub(b,f)),B=Math.pow(.25*L,-1/6)*Math.max(abs(sub(c,d)),abs(sub(c,e)),abs(sub(c,f)),abs(sub(c,b))),g=.25,h=1,w=complex(0);;){var r=sqrt(n),s=sqrt(o),t=sqrt(p),u=sqrt(q),m=add(mul(r,s),mul(r,t),mul(s,t)),E=mul(add(Am,m),g);n=mul(add(n,m),g),o=mul(add(o,m),g),p=mul(add(p,m),g),q=mul(add(q,m),g);var x=mul(add(u,r),add(u,s),add(u,t)),F=mul(z,h**3,inv(x),inv(x));if(h*B<abs(Am))break;var G=mul(carlsonRC(1,add(1,F)),h,inv(x));w=add(w,G),h*=g,Am=E}var v=div(h,Am),i=mul(sub(c,d),v),j=mul(sub(c,e),v),k=mul(sub(c,f),v),a=div(add(i,j,k),-2),l=add(mul(i,j),mul(i,k),mul(j,k),mul(-3,a,a)),y=add(mul(i,j,k),mul(2,l,a),mul(4,a,a,a)),H=mul(add(mul(2,i,j,k),mul(l,a),mul(3,a,a,a)),a),I=mul(i,j,k,a,a);a=add(24024,mul(-5148,l),mul(2457,l,l),mul(4004,y),mul(-4158,l,y),mul(-3276,H),mul(2772,I));var J=mul(h,pow(Am,-1.5),a,1/24024),K=mul(6,w);return add(J,K)}if(d<0||e<0||f<0||b<0)return carlsonRJ(complex(d),e,f,b);for(var n=d,o=e,p=f,q=b,c=Am=(d+e+f+2*b)/5,z=(b-d)*(b-e)*(b-f),B=Math.pow(.25*L,-1/6)*Math.max(Math.abs(c-d),Math.abs(c-e),Math.abs(c-f),Math.abs(c-b)),g=.25,h=1,w=0;;){var r=Math.sqrt(n),s=Math.sqrt(o),t=Math.sqrt(p),u=Math.sqrt(q),m=r*s+r*t+s*t,E=(Am+m)*g;n=(n+m)*g,o=(o+m)*g,p=(p+m)*g,q=(q+m)*g;var x=(u+r)*(u+s)*(u+t),F=z*h**3/x**2;if(h*B<Math.abs(Am))break;var G=carlsonRC(1,1+F)*h/x;w+=G,h*=g,Am=E}var v=h/Am,i=(c-d)*v,j=(c-e)*v,k=(c-f)*v,a=(-i-j-k)/2,l=i*j+i*k+j*k-3*a**2,y=i*j*k+2*l*a+4*a**3,H=(2*i*j*k+l*a+3*a**3)*a,I=i*j*k*a**2;a=24024-5148*l+2457*l**2+4004*y-4158*l*y-3276*H+2772*I;var J=h*Math.pow(Am,-1.5)*a/24024,K=6*w;return J+K}function ellipticF(a,b){if(1===arguments.length&&(b=a,a=pi/2),isComplex(a)||isComplex(b)){isComplex(a)||(a=complex(a));var c=complex(0);if(Math.abs(a.re)>pi/2){var d=Math.round(a.re/pi);a.re=a.re-d*pi,c=mul(2*d,ellipticK(b))}return add(mul(sin(a),carlsonRF(mul(cos(a),cos(a)),sub(1,mul(b,sin(a),sin(a))),1)),c)}if(b>1&&Math.abs(a)>Math.asin(1/Math.sqrt(b)))return ellipticF(complex(a),b);var c=0;if(Math.abs(a)>pi/2){var d=Math.round(a/pi);a-=d*pi,c=2*d*ellipticK(b)}return sin(a)*carlsonRF(cos(a)**2,1-b*sin(a)**2,1)+c}function ellipticK(a){return ellipticF(a)}function ellipticE(a,b){if(1===arguments.length&&(b=a,a=pi/2),isComplex(a)||isComplex(b)){isComplex(a)||(a=complex(a));var c=complex(0);if(Math.abs(a.re)>pi/2){var d=Math.round(a.re/pi);a.re=a.re-d*pi,c=mul(2*d,ellipticE(b))}return add(mul(sin(a),carlsonRF(mul(cos(a),cos(a)),sub(1,mul(b,sin(a),sin(a))),1)),mul(-1/3,b,pow(sin(a),3),carlsonRD(mul(cos(a),cos(a)),sub(1,mul(b,sin(a),sin(a))),1)),c)}if(b>1&&Math.abs(a)>Math.asin(1/Math.sqrt(b)))return ellipticE(complex(a),b);var c=0;if(Math.abs(a)>pi/2){var d=Math.round(a/pi);a-=d*pi,c=2*d*ellipticE(b)}return sin(a)*carlsonRF(cos(a)**2,1-b*sin(a)**2,1)-b/3*sin(a)**3*carlsonRD(cos(a)**2,1-b*sin(a)**2,1)+c}function ellipticPi(c,a,b){if(2===arguments.length&&(b=a,a=pi/2),isComplex(c)||isComplex(a)||isComplex(b)){isComplex(a)||(a=complex(a));var d=complex(0);if(Math.abs(a.re)>pi/2){var e=Math.round(a.re/pi);a.re=a.re-e*pi,d=mul(2*e,ellipticPi(c,b))}return add(mul(sin(a),carlsonRF(mul(cos(a),cos(a)),sub(1,mul(b,sin(a),sin(a))),1)),mul(1/3,c,pow(sin(a),3),carlsonRJ(mul(cos(a),cos(a)),sub(1,mul(b,sin(a),sin(a))),1,sub(1,mul(c,sin(a),sin(a))))),d)}if(c>1&&Math.abs(a)>Math.asin(1/Math.sqrt(c))||b>1&&Math.abs(a)>Math.asin(1/Math.sqrt(b)))return ellipticPi(c,complex(a),b);var d=0;if(Math.abs(a)>pi/2){var e=Math.round(a/pi);a-=e*pi,d=2*e*ellipticPi(c,b)}return sin(a)*carlsonRF(cos(a)**2,1-b*sin(a)**2,1)+c/3*sin(a)**3*carlsonRJ(cos(a)**2,1-b*sin(a)**2,1,1-c*sin(a)**2)+d}function jacobiZeta(b,a){return sub(ellipticE(b,a),mul(ellipticF(b,a),ellipticE(a),inv(ellipticK(a))))}function factorial(a){if(isComplex(a))return isPositiveIntegerOrZero(a)?complex(factorial(a.re)):gamma(add(a,1));if(isPositiveIntegerOrZero(a)){if(factorialCache[a])return factorialCache[a];for(var d=factorialCache.length-1,c=factorialCache[d],b=d+1;b<=a;b++)c*=b,factorialCache[b]=c;return c}return gamma(a+1)}function factorial2(a){if(isComplex(a)){if(isPositiveIntegerOrZero(a))return complex(factorial2(a.re));var d=pow(2,div(a,2)),e=pow(pi/2,div(sub(cos(mul(pi,a)),1),4)),f=gamma(add(div(a,2),1));return mul(d,e,f)}if(0===a)return 1;if(isPositiveInteger(a)){for(var b=1&a?1:2,c=b+2;c<=a;c+=2)b*=c;return b}return 2**(a/2)*(pi/2)**((cos(pi*a)-1)/4)*gamma(a/2+1)}function binomial(a,b){return isComplex(a)||isComplex(b)?div(factorial(a),mul(factorial(sub(a,b)),factorial(b))):Number.isInteger(b)&&b<0&&a>=0||Number.isInteger(a)&&Number.isInteger(b)&&a>=0&&b>a?0:factorial(a)/factorial(a-b)/factorial(b)}function multinomial(g){if(1===arguments.length)return isComplex(g)?complex(1):1;for(var a=0,b=1,e=0,d=0;d<arguments.length;d++){var f=arguments[d];if(a=add(a,f),isNegativeInteger(f)){var c=sub(-1,f);b=div(b,mul(chop(pow(-1,c)),factorial(c))),e++}else b=mul(b,factorial(arguments[d]))}if(isNegativeInteger(a)){if(--e>0)return isComplex(a)?complex(0):0;var c=sub(-1,a);return inv(mul(b,chop(pow(-1,c)),factorial(c)))}return e>0?isComplex(a)?complex(0):0:div(factorial(a),b)}function pochhammer(b,a){var d=isArbitrary(b)?arb1:1;if(isZero(a))return isComplex(b)||isComplex(a)?complex(d):d;if(isComplex(a)){if(isPositiveInteger(a)){var c=pochhammer(b,a.re);return isComplex(c)?c:complex(c)}return isArbitrary(b)&&!isArbitrary(a)&&(a=arbitrary(a)),div(gamma(add(b,a)),gamma(b))}if(isPositiveInteger(a)){for(var c=b,e=d,f=1;f<a;)c=mul(c,add(b,e)),e=add(e,d),f++;return c}return isArbitrary(b)&&!isArbitrary(a)&&(a=arbitrary(a)),div(gamma(add(b,a)),gamma(b))}function logGamma(a){if(isArbitrary(a)){var m=10n*arb1;if(isNegativeIntegerOrZero(arbitrary(a)))throw Error("Gamma function pole");if(abs(a)<m){for(var r=isComplex(a)?a.re:a,n=Math.ceil(arbitrary(m)-arbitrary(r)),j=ln(a),k=arb1,o=1;o<n;)j=add(j,ln(add(a,k))),k=add(k,arb1),o++;return sub(logGamma(add(a,arbitrary(n))),j)}if(a<0n&&(a=complex(a)),a.re<0n){var b,e,c,f=arb1;if(0===abs(a.im))b=neg(ln(sin(mul(a,onePi))));else if(a.im<0n){for(e=exp(mul(a,complex(0n,-twoPi))),c=complex(e.re,e.im),b=complex(e.re,e.im);0n!==c.re||0n!==c.im;)f+=arb1,c=mul(c,e),b=add(b,div(c,f));b=add(b,mul(a,complex(0n,-onePi)),ln(arb2))}else{for(e=exp(mul(a,complex(0n,twoPi))),c=complex(e.re,e.im),b=complex(e.re,e.im);0n!==c.re||0n!==c.im;)f+=arb1,c=mul(c,e),b=add(b,div(c,f));b=add(b,mul(a,complex(0n,onePi)),complex(0n,-onePi),ln(arb2))}return add(b,ln(onePi),neg(logGamma(sub(arb1,a))),complex(0n,halfPi))}var h,f=1,l=arb1,c=1n,d=0n;if(isComplex(a)){function s(){return0n!==c.re||0n!==c.im}h=complex(a.re,a.im)}else h=a;for(;s();){if(f===bernoulli2nN.length){console.log("Not enough Bernoulli numbers for logGamma");break}c=div(div(bernoulli2nN[f],bernoulli2nD[f]),mul(l+arb1,l,h)),d=add(d,c),h=mul(h,a,a),l+=arb2,f++}return add(mul(sub(a,arb1/2n),ln(a)),neg(a),div(ln(twoPi),arb2),d)}var p=[57.15623566586292,-59.59796035547549,14.136097974741746,-0.4919138160976202,3399464998481189e-20,4652362892704858e-20,-0.00009837447530487956,1580887032249125e-19,-0.00021026444172410488,21743961811521265e-20,-0.0001643181065367639,8441822398385275e-20,-0.000026190838401581408,36899182659531625e-22];if(isNegativeIntegerOrZero(a))throw Error("Gamma function pole");if(isComplex(a)){if(a.re<0){var q=log(div(pi,sin(mul(pi,a))));isNegativeIntegerOrZero((a.re+.5)/2)&&(q.im=pi*(a.im>0?1:-1));var b=sub(q,logGamma(sub(1,a))),d=a.im<0?-1:1,t=0===a.im?1/4:0,f=Math.ceil(a.re/2-3/4+t);return add(b,complex(0,2*d*f*pi))}var b=add(a,5.2421875);b=sub(mul(add(a,.5),log(b)),b);for(var d=.9999999999999971,g=0;g<14;g++)d=add(d,div(p[g],add(a,g+1)));var i=add(b,log(mul(2.5066282746310007,div(d,a))));return d.re<0&&(a.im<0&&div(d,a).im<0&&(i=add(i,complex(0,2*pi))),a.im>0&&div(d,a).im>0&&(i=add(i,complex(0,-2*pi)))),i}if(a<0)return logGamma(complex(a));var b=a+5.2421875;b=(a+.5)*log(b)-b;for(var d=.9999999999999971,g=0;g<14;g++)d+=p[g]/(a+g+1);return b+log(2.5066282746310007*d/a)}function gamma(a,b,e){if(2===arguments.length){if(isZero(a)){if(isZero(b))throw Error("Gamma function pole");var c=neg(expIntegralEi(neg(b),!0));return(b<0||b.re<0&&0===b.im)&&(c=sub(c,complex(0,pi))),c}if(isNegativeInteger(a)){for(var f=isComplex(a)?-a.re:-a,d=inv(b),g=d,h=1;h<f;h++)g=mul(g,-h,inv(b)),d=add(d,g);var i=mul(exp(neg(b)),d),c=sub(neg(expIntegralEi(neg(b),!0,1e-14)),i);return((b<0||b.re<0&&0===b.im)&&(c=sub(c,complex(0,pi))),c=mul((-1)**f/factorial(f),c),isComplex(a)&&!isComplex(c))?complex(c):c}return mul(exp(neg(b)),hypergeometricU(sub(1,a),sub(1,a),b))}return 3===arguments.length?isZero(b)?mul(pow(e,a),inv(a),hypergeometric1F1(a,add(a,1),neg(e))):sub(gamma(a,0,e),gamma(a,0,b)):isPositiveInteger(a)?factorial(sub(a,1)):!isComplex(a)&&a<0?exp(logGamma(complex(a))).re:exp(logGamma(a))}function gammaRegularized(a,b,c){return 3===arguments.length?div(gamma(a,b,c),gamma(a)):div(gamma(a,b),gamma(a))}function beta(b,a,c,d){return 4===arguments.length?sub(beta(a,c,d),beta(b,c,d)):3===arguments.length?mul(pow(b,a),inv(a),hypergeometric2F1(a,sub(1,c),add(a,1),b)):div(mul(gamma(b),gamma(a)),gamma(add(b,a)))}function betaRegularized(c,b,a,d){return 4===arguments.length?div(beta(c,b,a,d),beta(a,d)):div(beta(c,b,a),beta(b,a))}function polygamma(a,b){if(1===arguments.length)return digamma(b);if(!isPositiveInteger(a))throw Error("Unsupported polygamma index");return mul((-1)**(a+1)*factorial(a),hurwitzZeta(a+1,b))}function digamma(a){return diff(a=>logGamma(a),a)}function erf(a){var b=Math.abs(arg(a));return abs(a)>5&&(b<pi/4||b>3*pi/4)?sub(1,erfc(a)):mul(2/sqrt(pi),a,hypergeometric1F1(.5,1.5,neg(mul(a,a))))}function erfc(a){var b=Math.abs(arg(a));if(abs(a)>5&&(b<pi/4||b>3*pi/4)){var c=mul(1/sqrt(pi),exp(neg(mul(a,a))),inv(a),hypergeometric2F0(.5,1,neg(inv(mul(a,a)))));return a.re<0||a<0?add(2,c):c}return sub(1,erf(a))}function erfi(a){return mul(complex(0,-1),erf(mul(complex(0,1),a)))}function fresnelS(a){var c=hypergeometric1F1(.5,1.5,mul(complex(0,pi/2),pow(a,2))),d=hypergeometric1F1(.5,1.5,mul(complex(0,-pi/2),pow(a,2))),b=mul(a,sub(c,d),complex(0,-0.5));return isComplex(a)?b:b.re}function fresnelC(a){var c=hypergeometric1F1(.5,1.5,mul(complex(0,pi/2),pow(a,2))),d=hypergeometric1F1(.5,1.5,mul(complex(0,-pi/2),pow(a,2))),b=mul(a,add(c,d),.5);return isComplex(a)?b:b.re}function expIntegralEi(a,i=!1,e=1e-10){if(isUnity(neg(a)))return complexAverage(a=>expIntegralEi(a,i,e),a);var j=mul(a,complex(0,1));if(isUnity(j)||isUnity(neg(j)))return complexAverage(a=>expIntegralEi(a,i,e),a,complex(0,1e-5));var h=26;if(isComplex(a)){if(abs(a)>h){for(var c=complex(1),b=complex(1),f=b,d=1;(Math.abs(b.re)>e||Math.abs(b.im)>e)&&(b=mul(b,d,inv(a)),!(abs(b)>abs(f)));)c=add(c,b),d++,f=b;if(i)return mul(c,exp(a),inv(a));var g=a.im>0?1:a.im<0?-1:0;return add(mul(c,exp(a),inv(a)),complex(0,g*pi))}var k=abs(sub(a,h))/h;if(k>1&&abs(a)>1.5){setPrecisionScale(17+Math.round(10*(k-1)));for(var l=arbitrary(a),c=arbitrary(complex(0)),b=arbitrary(complex(1)),d=arb1;0n!==div(b.re,d)||0n!==div(b.im,d);)b=div(mul(b,l),d),c=add(c,div(b,d)),d=add(d,arb1);if(c=add(c,getConstant("eulerGamma"),ln(l)),i){var g=a.im>0n?-1n:a.im<0n?1n:0n;c=add(c,complex(0n,g*onePi))}c=arbitrary(c),resetPrecisionScale(),a.im>0&&0===a.re&&(c.im+=pi)}else{for(var c=complex(0),b=complex(1),d=1;Math.abs(b.re/d)>e||Math.abs(b.im/d)>e;)b=mul(b,a,1/d),c=add(c,div(b,d)),d++;if(c=add(c,eulerGamma,log(a)),i){var g=a.im>0?-1:a.im<0?1:0;c=add(c,complex(0,g*pi))}}return a.re<0&&0===a.im&&(c.im=0),c}if(a<0)return expIntegralEi(complex(a)).re;if(Math.abs(a)>h){for(var c=1,b=1,f=b,d=1;Math.abs(b)>e&&!(Math.abs(b*=d/a)>Math.abs(f));)c+=b,d++,f=b;return c*Math.exp(a)/a}for(var c=0,b=1,d=1;Math.abs(b/d)>e;)b*=a/d,c+=b/d,d++;return c+eulerGamma+Math.log(a)}function logIntegral(a){return expIntegralEi(log(a))}function sinIntegral(a){if(isZero(a))return isComplex(a)?complex(0):0;var b=mul(complex(0,1),a),c=mul(complex(0,.5),add(gamma(0,neg(b)),neg(gamma(0,b)),log(neg(b)),neg(log(b))));return isComplex(a)?c:c.re}function cosIntegral(a){var b=mul(complex(0,1),a),c=sub(log(a),mul(.5,add(gamma(0,neg(b)),gamma(0,b),log(neg(b)),log(b))));return a>0?c.re:(a.re>0&&0===a.im&&(c.im=chop(c.im)),c)}function sinhIntegral(a){if(isZero(a))return isComplex(a)?complex(0):0;var b=mul(.5,add(gamma(0,a),neg(gamma(0,neg(a))),log(a),neg(log(neg(a)))));return isComplex(a)?b:b.re}function coshIntegral(a){return mul(-0.5,add(gamma(0,a),gamma(0,neg(a)),neg(log(a)),log(neg(a))))}function expIntegralE(a,b){if(isZero(a))return div(exp(neg(b)),b);if(isZero(b)&&(a>1||a.re>1))return inv(sub(a,1));var c=pow(b,sub(a,1));return isInteger(a)&&b.re<0&&(c.im=chop(c.im)),mul(c,gamma(sub(1,a),b))}function hypergeometric0F1(a,b,h=1e-10){if(isNegativeIntegerOrZero(a))throw Error("Hypergeometric function pole");if(isComplex(a)||isComplex(b)){if(abs(b)>100){if(isNegativeIntegerOrZero(sub(a,.5))){var f=complexAverage(a=>hypergeometric0F1(a,b),a);return isReal(b)&&(f.im=0),f}var d=sub(mul(2,a),1);a=sub(a,.5),b=mul(4,sqrt(b));var i=mul(gamma(d),pow(neg(b),neg(a)),inv(gamma(sub(d,a))));i=mul(i,hypergeometric2F0(a,add(a,neg(d),1),div(-1,b)));var j=mul(gamma(d),pow(b,sub(a,d)),exp(b),inv(gamma(a)));j=mul(j,hypergeometric2F0(sub(d,a),sub(1,a),div(1,b)));var f=mul(exp(div(b,-2)),add(i,j));return isReal(a)&&isReal(b)&&(f.im=0),f}for(var e=complex(1),c=complex(1),g=1;Math.abs(c.re)>h||Math.abs(c.im)>h;)c=mul(c,b,inv(a),1/g),e=add(e,c),a=add(a,1),g++;return e}if(Math.abs(b)>100)return hypergeometric0F1(a,complex(b)).re;for(var e=1,c=1,g=1;Math.abs(c)>h;)c*=b/a/g,e+=c,a++,g++;return e}function hypergeometric1F1(a,b,c,h=1e-10){if(isEqualTo(a,b))return exp(c);if(isArbitrary(c)){if(isArbitrary(a)||(a=arbitrary(a)),isArbitrary(b)||(b=arbitrary(b)),isNegativeIntegerOrZero(arbitrary(b)))throw Error("Hypergeometric function pole");if(isComplex(c)){if(c.re<0n)return mul(exp(c),hypergeometric1F1(sub(b,a),b,neg(c)));for(var e=complex(arb1),d=complex(arb1),f=arb1;0n!==abs(d.re)||0n!==abs(d.im);)d=mul(d,c,a,inv(b),inv(f)),e=add(e,d),a=add(a,arb1),b=add(b,arb1),f+=arb1;return e}if(c<0n)return mul(exp(c),hypergeometric1F1(b-a,b,-c));for(var e=arb1,d=arb1,f=arb1;0n!==abs(d);)d=mul(d,c,a,inv(b),inv(f)),e+=d,a+=arb1,b+=arb1,f+=arb1;return e}var i=30;if(isNegativeIntegerOrZero(b))throw Error("Hypergeometric function pole");if(isComplex(a)||isComplex(b)||isComplex(c)){if(isZero(a))return complex(1);if(isComplex(c)||(c=complex(c)),c.re<0)return mul(exp(c),hypergeometric1F1(sub(b,a),b,neg(c)));if(abs(c)>i){if(isZero(a)||isNegativeIntegerOrZero(sub(b,a)))return complexAverage(a=>hypergeometric1F1(a,b,c),a);var j=mul(gamma(b),pow(neg(c),neg(a)),inv(gamma(sub(b,a))),hypergeometric2F0(a,add(a,neg(b),1),div(-1,c))),k=mul(gamma(b),pow(c,sub(a,b)),exp(c),inv(gamma(a)),hypergeometric2F0(sub(b,a),sub(1,a),div(1,c))),g=add(j,k);return isReal(a)&&isReal(b)&&isReal(c)&&(g.im=0),g}if(function(a){var c=Math.sqrt(3)-1;if(a.re>0){var b=c*a.re+i/2;return a.im>b||a.im< -b}var b=-c*a.re+i/2;return a.im>b||a.im< -b}(c)){setPrecisionScale(22);var g=arbitrary(hypergeometric1F1(a,b,arbitrary(c)));return resetPrecisionScale(),g}for(var e=complex(1),d=complex(1),f=1;Math.abs(d.re)>h||Math.abs(d.im)>h;)d=mul(d,c,a,inv(b),1/f),e=add(e,d),a=add(a,1),b=add(b,1),f++;return e}if(isZero(a))return 1;if(c<0)return exp(c)*hypergeometric1F1(b-a,b,-c);if(Math.abs(c)>i)return hypergeometric1F1(a,b,complex(c)).re;for(var e=1,d=1,f=1;Math.abs(d)>h;)d*=c*a/b/f,e+=d,a++,b++,f++;return e}function hypergeometricU(b,a,c){if(isEqualTo(add(b,1),a))return pow(c,neg(b));if(isZero(b))return isComplex(b)||isComplex(a)||isComplex(c)?complex(1):1;var g=25;if(abs(c)>g)return mul(pow(c,neg(b)),hypergeometric2F0(b,add(b,neg(a),1),neg(inv(c))));if(isUnity(b)&&isUnity(a))return mul(exp(c),gamma(0,c));if(isUnity(a))return complexAverage(a=>hypergeometricU(b,a,c),a);if(isPositiveInteger(b)&&isEqualTo(b,a))return mul(exp(c),gamma(sub(1,b),c));var d=mul(gamma(sub(a,1)),inv(gamma(b)),pow(c,sub(1,a)),hypergeometric1F1(add(b,neg(a),1),sub(2,a),c)),e=mul(gamma(sub(1,a)),inv(gamma(add(b,neg(a),1))),hypergeometric1F1(b,a,c)),f=Math.max(abs(d),abs(e));if(f<100)return add(d,e);setPrecisionScale(defaultDecimals+ +f.toExponential().split("e")[1]),b=arbitrary(b),a=arbitrary(a),c=arbitrary(c),d=mul(gamma(sub(a,arb1)),inv(gamma(b)),pow(c,sub(arb1,a)),hypergeometric1F1(add(b,neg(a),arb1),sub(arb2,a),c)),e=mul(gamma(sub(arb1,a)),inv(gamma(add(b,neg(a),arb1))),hypergeometric1F1(b,a,c));var h=arbitrary(add(d,e));return resetPrecisionScale(),h}function whittakerM(c,a,b){return mul(exp(mul(-0.5,b)),pow(b,add(a,.5)),hypergeometric1F1(add(a,neg(c),.5),add(mul(2,a),1),b))}function whittakerW(c,a,b){return mul(exp(mul(-0.5,b)),pow(b,add(a,.5)),hypergeometricU(add(a,neg(c),.5),add(mul(2,a),1),b))}function hypergeometric2F0(d,e,h,i=1e-10){if(isComplex(d)||isComplex(e)||isComplex(h)){for(var f=complex(1),a=complex(1),b=a,g=!1,c=1;(Math.abs(a.re)>i||Math.abs(a.im)>i)&&(a=mul(a,h,d,e,1/c),!(abs(a)>abs(b))||!g);){if(abs(a)<abs(b)&&(g=!0),c>50)throw Error("Not converging after 50 terms");f=add(f,a),d=add(d,1),e=add(e,1),c++,b=a}return f}for(var f=1,a=1,b=a,g=!1,c=1;Math.abs(a)>i&&(!(Math.abs(a*=h*d*e/c)>Math.abs(b))||!g);){if(Math.abs(a)<Math.abs(b)&&(g=!0),c>50)throw Error("Not converging after 50 terms");f+=a,d++,e++,c++,b=a}return f}function hypergeometric2F1(a,b,c,d,j=1e-10){if(isEqualTo(a,c))return pow(sub(1,d),neg(b));if(isEqualTo(b,c))return pow(sub(1,d),neg(a));if(!isUnity(neg(d))&&abs(add(d,1))<j)return hypergeometric2F1(a,b,c,isComplex(d)?complex(-1):-1);if(isNegativeIntegerOrZero(c))throw Error("Hypergeometric function pole");if(isComplex(a)||isComplex(b)||isComplex(c)||isComplex(d)){if(isZero(a)||isZero(b))return complex(1);var k=[abs(d),abs(div(d,sub(d,1))),abs(sub(1,d)),abs(inv(d)),abs(inv(sub(1,d))),abs(sub(1,inv(d)))],l=k.indexOf(Math.min.apply(null,k));switch(l){case 0:break;case 1:return mul(pow(sub(1,d),neg(a)),hypergeometric2F1(a,sub(c,b),c,div(d,sub(d,1))));case 2:if(isInteger(sub(c,add(a,b)))||isNegativeIntegerOrZero(sub(c,a)))return complexAverage(a=>hypergeometric2F1(a,b,c,d),a);if(isNegativeIntegerOrZero(sub(c,b)))return complexAverage(b=>hypergeometric2F1(a,b,c,d),b);var e=mul(gamma(c),gamma(sub(c,add(a,b))),inv(gamma(sub(c,a))),inv(gamma(sub(c,b))),hypergeometric2F1(a,b,add(a,b,neg(c),1),sub(1,d))),f=mul(pow(sub(1,d),sub(c,add(a,b))),gamma(c),gamma(sub(add(a,b),c)),inv(gamma(a)),inv(gamma(b)),hypergeometric2F1(sub(c,a),sub(c,b),add(c,neg(a),neg(b),1),sub(1,d)));return add(e,f);case 3:if(isInteger(sub(a,b))||isNegativeIntegerOrZero(sub(c,a)))return complexAverage(a=>hypergeometric2F1(a,b,c,d),a);if(isNegativeIntegerOrZero(sub(c,b)))return complexAverage(b=>hypergeometric2F1(a,b,c,d),b);var e=mul(gamma(c),gamma(sub(b,a)),inv(gamma(b)),inv(gamma(sub(c,a))),pow(neg(d),neg(a)),hypergeometric2F1(a,add(1,neg(c),a),add(1,neg(b),a),inv(d))),f=mul(gamma(c),gamma(sub(a,b)),inv(gamma(a)),inv(gamma(sub(c,b))),pow(neg(d),neg(b)),hypergeometric2F1(b,add(1,neg(c),b),add(1,neg(a),b),inv(d)));return add(e,f);case 4:if(isInteger(sub(a,b))||isNegativeIntegerOrZero(sub(c,a)))return complexAverage(a=>hypergeometric2F1(a,b,c,d),a);if(isNegativeIntegerOrZero(sub(c,b)))return complexAverage(b=>hypergeometric2F1(a,b,c,d),b);var e=mul(pow(sub(1,d),neg(a)),gamma(c),gamma(sub(b,a)),inv(gamma(b)),inv(gamma(sub(c,a))),hypergeometric2F1(a,sub(c,b),add(a,neg(b),1),inv(sub(1,d)))),f=mul(pow(sub(1,d),neg(b)),gamma(c),gamma(sub(a,b)),inv(gamma(a)),inv(gamma(sub(c,b))),hypergeometric2F1(b,sub(c,a),add(b,neg(a),1),inv(sub(1,d))));return add(e,f);case 5:if(isInteger(sub(c,add(a,b)))||isNegativeIntegerOrZero(sub(c,a)))return complexAverage(a=>hypergeometric2F1(a,b,c,d),a);if(isNegativeIntegerOrZero(sub(c,b)))return complexAverage(b=>hypergeometric2F1(a,b,c,d),b);var e=mul(gamma(c),gamma(sub(c,add(a,b))),inv(gamma(sub(c,a))),inv(gamma(sub(c,b))),pow(d,neg(a)),hypergeometric2F1(a,add(a,neg(c),1),add(a,b,neg(c),1),sub(1,inv(d)))),f=mul(gamma(c),gamma(sub(add(a,b),c)),inv(gamma(a)),inv(gamma(b)),pow(sub(1,d),sub(c,add(a,b))),pow(d,sub(a,c)),hypergeometric2F1(sub(c,a),sub(1,a),add(c,neg(a),neg(b),1),sub(1,inv(d))));return add(e,f)}for(var h=complex(1),g=complex(1),i=1;Math.abs(g.re)>j||Math.abs(g.im)>j;)g=mul(g,d,a,b,inv(c),1/i),h=add(h,g),a=add(a,1),b=add(b,1),c=add(c,1),i++;return h}if(isZero(a)||isZero(b))return 1;if(d< -1){var e=gamma(c)*gamma(b-a)/gamma(b)/gamma(c-a)*(-d)** -a*hypergeometric2F1(a,1-c+a,1-b+a,1/d),f=gamma(c)*gamma(a-b)/gamma(a)/gamma(c-b)*(-d)** -b*hypergeometric2F1(b,1-c+b,1-a+b,1/d);return e+f}if(-1===d)return hypergeometric2F1(a,b,c,complex(d)).re;if(1===d){if(c-a-b>0)return gamma(c)*gamma(c-a-b)/gamma(c-a)/gamma(c-b);throw Error("Divergent Gauss hypergeometric function")}if(d>1)return hypergeometric2F1(a,b,c,complex(d));for(var h=1,g=1,i=1;Math.abs(g)>j;)g*=d*a*b/c/i,h+=g,a++,b++,c++,i++;return h}function hypergeometric1F2(a,b,c,e,v=1e-10){if(isComplex(a)||isComplex(b)||isComplex(c)||isComplex(e)){if(abs(e)>150){var g=add(a,neg(b),neg(c)),q=div(add(g,.5),2),f=[1];f[1]=add(mul(add(mul(3,a),b,c,-2),g,.5),mul(2,b,c),-3/8);var r=add(mul(b,c),mul(g,add(mul(3,a),b,c,-2),1/4),-3/16);f[2]=add(mul(2,r,r),neg(mul(sub(mul(2,a),3),b,c)),mul(g,add(mul(-8,mul(a,a)),mul(11,a),b,c,-2),1/4),-3/16);var j=complex(0,1),k=complex(0,-1);function h(a){return mul(1/2**a,f[a],pow(neg(e),-a/2))}for(var s=h(1),t=h(2),l=add(1,mul(k,s),neg(t)),m=add(1,mul(j,s),neg(t)),d=2,i=h(d),n=powMinusI=-1;abs(i)>v;){d++,n=mul(n,j),powMinusI=mul(powMinusI,k);var o=mul(add(3*d**2,mul(2*d,add(mul(-3,a),b,c,-2)),mul(3,mul(a,a)),neg(mul(sub(b,c),sub(b,c))),neg(mul(2,a,add(b,c,-2))),1/4),f[d-1]),p=mul(add(d,neg(a),b,neg(c),-0.5),add(d,neg(a),neg(b),c,-0.5),add(d,neg(a),b,c,-2.5),f[d-2]);f[d]=div(sub(o,p),2*d),i=h(d),l=add(l,mul(powMinusI,i)),m=add(m,mul(n,i))}var u=add(mul(pi,q),mul(2,sqrt(neg(e)))),w=exp(mul(j,u)),x=exp(mul(k,u)),y=add(mul(w,l),mul(x,m)),o=mul(1/(2*sqrt(pi)),inv(gamma(a)),pow(neg(e),q),y),p=mul(inv(gamma(sub(b,a))),inv(gamma(sub(c,a))),pow(neg(e),neg(a)),hypergeometricSeries([a,add(a,neg(b),1),add(a,neg(c),1)],[],inv(e),!0));return mul(gamma(b),gamma(c),add(o,p))}return hypergeometricSeries([a],[b,c],e,!0)}return Math.abs(e)>150?hypergeometric1F2(a,b,c,complex(e)).re:hypergeometricSeries([a],[b,c],e)}function hypergeometricSeries(c,d,h,i=!1,g=1e-10){if(i){for(var e=complex(1),b=complex(1),f=1;Math.abs(b.re)>g||Math.abs(b.im)>g;){for(var a=0;a<c.length;a++)b=mul(b,c[a]),c[a]=add(c[a],1);for(var a=0;a<d.length;a++)b=div(b,d[a]),d[a]=add(d[a],1);b=mul(b,h,1/f),e=add(e,b),f++}return e}for(var e=1,b=1,f=1;Math.abs(b)>g;){for(var a=0;a<c.length;a++)b*=c[a],c[a]++;for(var a=0;a<d.length;a++)b/=d[a],d[a]++;b*=h/f,e+=b,f++}return e}function hypergeometricPFQ(b,c,a){if(abs(a)>1)throw Error("General hypergeometric argument currently restricted");var d=!1;return(b.forEach(a=>d=d||isComplex(a)),c.forEach(a=>d=d||isComplex(a)),d||isComplex(a))?hypergeometricSeries(b,c,a,!0):hypergeometricSeries(b,c,a)}function exp(a){if(isArbitrary(a)){if(isComplex(a)){var e=exp(a.re);return{re:mul(e,cos(a.im)),im:mul(e,sin(a.im))}}var b=div(a,ln10)/precisionScale;a-=b*ln10;for(var c=arb1,d=arb1,f=arb1;0n!==d;)d=div(mul(d,a),f),c+=d,f+=arb1;return b>0n&&(c*=10n**b),b<0n&&(c/=10n** -b),c}return isComplex(a)?{re:Math.exp(a.re)*Math.cos(a.im),im:Math.exp(a.re)*Math.sin(a.im)}:Math.exp(a)}function log(a,b){return isComplex(a)?isComplex(b)?div(log(a),log(b)):{re:log(abs(a),b),im:log(Math.E,b)*arg(a)}:a<0?log(complex(a),b):void 0===b?Math.log(a):Math.log(a)/Math.log(b)}function ln(a){if(isArbitrary(a)){if(!isComplex(a)){if(a<0n)return{re:ln(-a),im:getConstant("pi")};if(a===arb1)return0n;if(a<arb1)return-ln(div(arb1,a))}if(abs(a)<arb1)return neg(ln(div(arb1,a)));var c=function(c){var a=mul(arb2,c),d=a,e=1;if(isComplex(c))for(;0n!==a.re||0n!==a.im;){for(var b=0;b<8*e;b++)a=mul(a,c);d=add(d,a),e++}else for(;0n!==a;){for(var b=0;b<8*e;b++)a=mul(a,c);d+=a,e++}return d}(a=div(arb1,a)),d=function(e){var a=arb2,c=arb1,d=1;if(isComplex(e))for(;0n!==a.re||0n!==a.im;){for(var b=0;b<4*(2*d-1);b++)a=mul(a,e);c=add(c,a),d++}else for(;0n!==a;){for(var b=0;b<4*(2*d-1);b++)a=mul(a,e);c+=a,d++}return c}(a),b=div(onePi,mul(arbitrary(4),function(a,b){var c,d;if(isComplex(a))for(var e=20,f=0;(a.re!==b.re||a.im!==b.im)&&(a=div(add(c=a,d=b),arb2),b=sqrt(mul(c,d)),!(++f>e)););else for(;a!==b;)a=div((c=a)+(d=b),arb2),b=sqrt(mul(c,d));return a}(mul(c,c),mul(d,d))));return a.re<0n&&(b.im>0n?b.im-=onePi:b.im+=onePi),b}return log(a)}function lambertW(b,a,d=1e-10){if(1===arguments.length&&(a=b,b=0),!Number.isInteger(b))throw Error("Unsupported Lambert W index");if(isZero(a)){if(0===b)return a;throw Error("Lambert W pole")}var e=Math.exp(-1);if((0===b|| -1===b)&&abs(add(a,e))<d*d)return isComplex(a)?complex(-1):-1;if(!isComplex(a)){if(0===b&&a> -e)return findRoot(b=>b*Math.exp(b)-a,[-1,1e3],{tolerance:d});if(-1===b&&a> -e&&a<0)return findRoot(b=>b*Math.exp(b)-a,[-1e3,-1],{tolerance:d});a=complex(a)}if(0===b&&1.25>abs(a)){0===a.im&&a.re< -e&&(a.im=d);var c=a.re<.5?complex(0,.5*Math.sign(a.im)):complex(0)}else var f=add(log(a),complex(0,2*pi*b)),c=sub(f,log(f));for(var g=0;g<100;g++){var h=div(sub(mul(c,exp(c)),a),mul(exp(c),add(c,1)));if(c=sub(c,h),abs(h)<d)return c}throw Error("No Lambert W root found at "+JSON.stringify(a))}function inverseLambertW(a){return mul(a,exp(a))}function chop(a,d=1e-10){if(Array.isArray(a)){for(var c=vector(a.length),b=0;b<a.length;b++)c[b]=chop(a[b]);return c}return isComplex(a)?complex(chop(a.re),chop(a.im)):(Math.abs(a)<d&&(a=0),a)}function round(a,b){return 2===arguments.length?mul(b,round(div(a,b))):isComplex(a)?complex(Math.round(a.re),Math.round(a.im)):Math.round(a)}function ceiling(a){return isComplex(a)?complex(Math.ceil(a.re),Math.ceil(a.im)):Math.ceil(a)}function floor(a){return isComplex(a)?complex(Math.floor(a.re),Math.floor(a.im)):Math.floor(a)}function sign(a){return isZero(a)?a:div(a,abs(a))}function integerPart(a){return isComplex(a)?complex(Math.trunc(a.re),Math.trunc(a.im)):Math.trunc(a)}function fractionalPart(a){return sub(a,integerPart(a))}function kronecker(a,b){if(2===arguments.length)return isComplex(a)||isComplex(b)?(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),kronecker(a.re,b.re)*kronecker(a.im,b.im)):a===b?1:0;for(var d=kronecker(a,b),c=2;c<arguments.length;c++)d*=kronecker(a,arguments[c]);return d}function piecewise(){var a=arguments;return function(c){for(var b=0;b<a.length;b++){var d=a[b][1];if(c>=d[0]&&c<=d[1])return a[b][0](c)}return 0}}function hermite(a,b){function d(e){var f,a,b=[1],c=[2,0];if(0===e)return b;if(1===e)return c;for(var g=2;g<=e;g++){a=[],(f=c.slice()).push(0),b.unshift(0,0);for(var d=0;d<f.length;d++)a.push(2*f[d]-2*(g-1)*b[d]);b=c,c=a}return a}if(isComplex(a)||isComplex(b)){if(isComplex(a)||(a=complex(a)),Number.isInteger(a.re)&&a.re>=0&&0===a.im)return polynomial(b,d(a.re));var e=div(a,-2),f=div(sub(1,a),2),c=sub(div(hypergeometric1F1(e,.5,pow(b,2)),gamma(f)),mul(2,b,div(hypergeometric1F1(f,1.5,pow(b,2)),gamma(e))));return mul(pow(2,a),sqrt(pi),c)}if(Number.isInteger(a)&&a>=0)return polynomial(b,d(a));var c=hypergeometric1F1(-a/2,.5,b**2)/gamma((1-a)/2)-2*b*hypergeometric1F1((1-a)/2,1.5,b**2)/gamma(-a/2);return 2**a*sqrt(pi)*c}function laguerre(b,a,c){return arguments.length<3&&(c=a,a=0),mul(binomial(add(b,a),b),hypergeometric1F1(neg(b),add(a,1),c))}function chebyshevT(a,b){return cos(mul(a,arccos(b)))}function chebyshevU(b,a){return div(sin(mul(add(b,1),arccos(a))),sin(arccos(a)))}function legendreP(b,a,c,i=!1){if(arguments.length<3&&(c=a,a=0),Number.isInteger(b)&&Number.isInteger(a)&&1>=Math.abs(c)){var d=Math.abs(a);if(d>b)throw Error("Invalid spherical harmonic indices");if(!i){for(var e=1,j=b-a+1;j<=b+a;j++)e*=j;e=Math.sqrt(4*pi*e/(2*b+1))}var g=(-1)**d*Math.sqrt((2*d+1)/4/pi/factorial(2*d))*factorial2(2*d-1)*(1-c*c)**(d/2);if(d===b)return i?g:e*g;var f=d+1,k=Math.sqrt(2*d+3),h=k*c*g;if(f===b)return i?h:e*h;for(;f<b;){var m=Math.sqrt((4* ++f*f-1)/(f*f-d*d)),l=m*(c*h-g/k);g=h,h=l,k=m}return i?l:e*l}return isPositiveInteger(a)?mul(pow(-1,a),inv(gamma(add(a,1))),gamma(add(b,a,1)),inv(gamma(add(b,neg(a),1))),pow(add(1,c),div(a,-2)),pow(sub(1,c),div(a,2)),hypergeometric2F1(neg(b),add(b,1),add(a,1),div(sub(1,c),2))):mul(inv(gamma(sub(1,a))),pow(add(1,c),div(a,2)),pow(sub(1,c),div(a,-2)),hypergeometric2F1(neg(b),add(b,1),sub(1,a),div(sub(1,c),2)))}function sphericalHarmonic(b,a,c,d){var e=legendreP(b,a,cos(c),!0);return mul(Math.sign(a)**a,e,exp(complex(0,a*d)))}function legendreQ(d,a,b){function c(a){var c=mul(cos(mul(pi,a)),legendreP(d,a,b)),e=mul(gamma(add(d,a,1)),inv(gamma(add(d,neg(a),1))),legendreP(d,neg(a),b));return sub(c,e)}return(arguments.length<3&&(b=a,a=0),isInteger(a))?(!(abs(b)>1)||isComplex(a)||1&a||(a=complex(a)),mul(.5,pow(-1,a),diff(a=>c(a),a))):mul(pi/2,inv(sin(mul(pi,a))),c(a))}function doubleLambert(d,a,c,g=1e-10){if(2===arguments.length&&(c=a,a=d,d=0),isZero(c))return lambertW(d,a);if(isZero(a))return neg(lambertW(-d,neg(c)));function k(a,b,c){return add(log(sqrt(b)),neg(log(sqrt(neg(c)))),complex(0,a*pi))}for(var h=100,b=function(a,c,d,b=.001){var e,f,g,i,j,h=k(a,c,d),l=.9;return abs((g=a,div(k(g,i=c,j=d),add(1,mul(2*(-1)**g,sqrt(i),sqrt(neg(j)))))))<l?h:(0===a&&console.log("Using Lambert W on principal branch"),1&a?a>0?(e=lambertW((a+1)/2,c,b),f=neg(lambertW(-(a+1)/2,neg(d),b))):(e=lambertW((a-1)/2,c,b),f=neg(lambertW(-(a-1)/2,neg(d),b))):(e=lambertW(a/2,c,b),f=neg(lambertW(-a/2,neg(d),b))),Math.abs(e.im-h.im)<Math.abs(f.im-h.im))?e:f}(d,a,c),e=0;e<h;e++){var i=add(mul(a,exp(neg(b))),mul(c,exp(b)),neg(b)),j=add(mul(-1,a,exp(neg(b))),mul(c,exp(b)),-1),f=div(i,j);if(b=sub(b,f),abs(f)<g)return b}throw Error("No double Lambert root found for x = "+JSON.stringify(a)+" and y = "+JSON.stringify(c))}function sin(a){if(isArbitrary(a)){if(isComplex(a))return{re:mul(sin(a.re),cosh(a.im)),im:mul(cos(a.re),sinh(a.im))};if((a%=twoPi)>halfPi)return sin(onePi-a);if(a< -halfPi)return sin(-onePi-a);for(var d=a,b=a,c=arb2;0n!==b;)b=div(mul(b,-arb1,a,a),mul(c,c+arb1)),d+=b,c+=arb2;return d}return isComplex(a)?{re:Math.sin(a.re)*Math.cosh(a.im),im:Math.cos(a.re)*Math.sinh(a.im)}:Math.sin(a)}function cos(a){if(isArbitrary(a)){if(isComplex(a))return{re:mul(cos(a.re),cosh(a.im)),im:-mul(sin(a.re),sinh(a.im))};if((a%=twoPi)>halfPi)return-cos(onePi-a);if(a< -halfPi)return-cos(-onePi-a);for(var d=arb1,b=arb1,c=arb1;0n!==b;)b=div(mul(b,-arb1,a,a),mul(c,c+arb1)),d+=b,c+=arb2;return d}return isComplex(a)?{re:Math.cos(a.re)*Math.cosh(a.im),im:-Math.sin(a.re)*Math.sinh(a.im)}:Math.cos(a)}function tan(a){return isComplex(a)?div(sin(a),cos(a)):Math.tan(a)}function cot(a){return isComplex(a)?div(cos(a),sin(a)):1/Math.tan(a)}function sec(a){return isComplex(a)?div(1,cos(a)):1/Math.cos(a)}function csc(a){return isComplex(a)?div(1,sin(a)):1/Math.sin(a)}function arcsin(a){if(isComplex(a)){var b=sqrt(sub(1,mul(a,a)));return b=add(mul(complex(0,1),a),b),mul(complex(0,-1),log(b))}return 1>=Math.abs(a)?Math.asin(a):arcsin(complex(a))}function arccos(a){return isComplex(a)?sub(pi/2,arcsin(a)):1>=Math.abs(a)?Math.acos(a):arccos(complex(a))}function arctan(a){if(isComplex(a)){var b=sub(log(sub(1,mul(complex(0,1),a))),log(add(1,mul(complex(0,1),a))));return mul(complex(0,.5),b)}return Math.atan(a)}function arccot(a){return isComplex(a)?arctan(div(1,a)):Math.atan(1/a)}function arcsec(a){return isComplex(a)?arccos(div(1,a)):Math.abs(a)>=1?Math.acos(1/a):arcsec(complex(a))}function arccsc(a){return isComplex(a)?arcsin(div(1,a)):Math.abs(a)>=1?Math.asin(1/a):arccsc(complex(a))}function sinh(a){return isArbitrary(a)?div(sub(exp(a),exp(neg(a))),arb2):isComplex(a)?{re:Math.sinh(a.re)*Math.cos(a.im),im:Math.cosh(a.re)*Math.sin(a.im)}:Math.sinh(a)}function cosh(a){return isArbitrary(a)?div(add(exp(a),exp(neg(a))),arb2):isComplex(a)?{re:Math.cosh(a.re)*Math.cos(a.im),im:Math.sinh(a.re)*Math.sin(a.im)}:Math.cosh(a)}function tanh(a){return isComplex(a)?div(sinh(a),cosh(a)):Math.tanh(a)}function coth(a){return isComplex(a)?div(cosh(a),sinh(a)):1/Math.tanh(a)}function sech(a){return isComplex(a)?div(1,cosh(a)):1/Math.cosh(a)}function csch(a){return isComplex(a)?div(1,sinh(a)):1/Math.sinh(a)}function arcsinh(a){if(isComplex(a)){var b=sqrt(add(mul(a,a),1));return b=add(a,b),log(b)}return Math.asinh(a)}function arccosh(a){if(isComplex(a)){var b=mul(sqrt(add(a,1)),sqrt(sub(a,1)));return b=add(a,b),log(b)}return a>=1?Math.acosh(a):arccosh(complex(a))}function arctanh(a){if(isComplex(a)){var b=sub(log(add(1,a)),log(sub(1,a)));return mul(.5,b)}return 1>=Math.abs(a)?Math.atanh(a):arctanh(complex(a))}function arccoth(a){if(isComplex(a)){if(0===a.re&&0===a.im)throw Error("Indeterminate arccoth value");return arctanh(div(1,a))}return Math.abs(a)>1?Math.atanh(1/a):arccoth(complex(a))}function arcsech(a){if(isComplex(a)){if(0===a.re&&0===a.im)throw Error("Indeterminate arcsech value");return 0===a.im&&(a.im=-Number.MIN_VALUE),arccosh(div(1,a))}return a>0&&a<1?Math.acosh(1/a):arcsech(complex(a))}function arccsch(a){return isComplex(a)?arcsinh(div(1,a)):Math.asinh(1/a)}function sinc(a){return isComplex(a)?0===a.re&&0===a.im?complex(1):div(sin(a),a):0===a?1:Math.sin(a)/a}function haversine(a){return div(sub(1,cos(a)),2)}function inverseHaversine(a){return arccos(sub(1,mul(2,a)))}function gudermannian(a){return mul(2,arctan(tanh(div(a,2))))}function inverseGudermannian(a){return mul(2,arctanh(tan(div(a,2))))}function zeta(a,f=1e-10){if(isEqualTo(a,1))throw Error("Riemann zeta pole");if(a<0||a.re<0)return mul(pow(2,a),pow(pi,sub(a,1)),sin(mul(pi/2,a)),gamma(sub(1,a)),zeta(sub(1,a)));var h=5;if(a>h||a.re>h){if(isComplex(a)){for(var d=complex(1),e=complex(1),b=2;Math.abs(e.re)>f||Math.abs(e.im)>f*f;)e=pow(b,neg(a)),d=add(d,e),b++;return d}for(var d=1,e=1,b=2;Math.abs(e)>f;)e=1/b**a,d+=e,b++;return d}var c=14;isComplex(a)&&0!==a.im&&(c=Math.max(c,Math.ceil(log(2/abs(gamma(a))/f)/log(3+sqrt(8)))));for(var g=[1],i=c,b=1;b<=c;b++)g.push(g[b-1]+c*i/factorial(2*b)*4**b),i*=(c+b)*(c-b);if(isComplex(a)){var d=summation(b=>div((-1)**b*(g[b]-g[c]),pow(b+1,a)),[0,c-1]);return div(div(d,-g[c]),sub(1,pow(2,sub(1,a))))}var d=summation(b=>(-1)**b*(g[b]-g[c])/(b+1)**a,[0,c-1]);return-d/g[c]/(1-2**(1-a))}function dirichletEta(a){return mul(zeta(a),sub(1,pow(2,sub(1,a))))}function bernoulli(a,b){if(!Number.isInteger(a))throw Error("Noninteger index for Bernoulli number");if(a<0)throw Error("Unsupported index for Bernoulli number");return arguments.length>1&&!isZero(b)?mul(-a,hurwitzZeta(1-a,b)):0===a?1:1===a?-0.5:1&a?0:-a*zeta(1-a)}function harmonic(a){if(!Number.isInteger(a))throw Error("Noninteger index for harmonic number");return a>1e3?log(a)+eulerGamma+.5/a-1/12/a**2:summation(a=>1/a,[1,a])}function hurwitzZeta(a,b,k=1e-10){if(isEqualTo(a,1))throw Error("Hurwitz zeta pole");if(isNegativeIntegerOrZero(b))throw Error("Hurwitz zeta parameter pole");if(isComplex(a)||isComplex(b)){if(isComplex(a)||(a=complex(a)),isComplex(b)||(b=complex(b)),b.re<0){var n=-Math.floor(b.re);return add(hurwitzZeta(a,add(b,n)),summation(c=>pow(add(b,c),neg(a)),[0,n-1]))}var f=15;if(a.re<0){setPrecisionScale(20-Math.round(a.re)),a=arbitrary(a),b=arbitrary(b);for(var h=arbitrary(f),p=arbitrary(3),g=0n,c=0;c<f;c++)g=add(g,pow(div(add(b,h),add(b,arbitrary(c))),a));for(var i=div(add(b,h),sub(a,arb1)),d=div(mul(arb1/2n,a),add(b,h)),m=div(bernoulli2nN[1],bernoulli2nD[1]),e=mul(m,d),c=arb2,l=2;(0n!==d.re||0n!==d.im)&&l!==bernoulli2nN.length;)d=div(mul(d,add(a,2n*c-arb2),add(a,2n*c-p)),mul(2n*c,2n*c-arb1,add(b,h),add(b,h))),m=div(bernoulli2nN[l],bernoulli2nD[l]),e=add(e,mul(m,d)),c+=arb1,l++;var j=add(arb1/2n,e),q=arbitrary(mul(add(g,i,j),pow(add(b,h),mul(-arb1,a))));return resetPrecisionScale(),q}for(var g=summation(c=>pow(add(b,c),neg(a)),[0,f-1]),i=div(pow(add(b,f),sub(1,a)),sub(a,1)),d=mul(.5,a,inv(add(b,f))),e=mul(bernoulli(2),d),c=2;Math.abs(d.re)>k||Math.abs(d.im)>k;)d=div(mul(d,add(a,2*c-2),add(a,2*c-3)),mul(2*c*(2*c-1),add(b,f),add(b,f))),e=add(e,mul(bernoulli(2*c),d)),c++;var j=div(add(.5,e),pow(add(b,f),a));return add(g,i,j)}if(b<0)return hurwitzZeta(a,complex(b));if(a< -5){for(var e=Math.cos(pi*(a=1-a)/2-2*pi*b),o=e,c=1;Math.abs(e)>k;)e=Math.cos(pi*a/2-2* ++c*pi*b)/c**a,o+=e;return 2*gamma(a)/(2*pi)**a*o}for(var f=15,g=summation(c=>1/(b+c)**a,[0,f-1]),i=(b+f)**(1-a)/(a-1),d=a/2/(b+f),e=bernoulli(2)*d,c=2;Math.abs(d)>k;)d*=(a+2*c-2)*(a+2*c-3)/(2*c*(2*c-1)*(b+f)**2),e+=bernoulli(2*c)*d,c++;var j=(.5+e)/(b+f)**a;return g+i+j}function polylog(b,a,h=1e-10){if(isEqualTo(a,1))return zeta(b);if(isEqualTo(a,-1))return neg(dirichletEta(b));if(isEqualTo(b,1))return neg(log(sub(1,a)));if(isEqualTo(b,0))return div(a,sub(1,a));if(isEqualTo(b,-1))return div(a,mul(sub(1,a),sub(1,a)));if(abs(a)>=1){var g=complex(0,2*pi);if(isPositiveInteger(b)){var m=mul((-1)**b,polylog(b,inv(a))),n=mul(div(pow(g,b),factorial(b)),bernoulli(b,div(log(a),g))),i=isComplex(a)?a:complex(a),o=i.im<0||0===i.im&&i.re>=1?mul(g,div(pow(log(a),b-1),factorial(b-1))):0,j=neg(add(m,n,o));return!isComplex(a)&&a<0?j.re:j}var e=sub(1,b),k=complex(0,1),l=div(log(neg(a)),g),p=mul(pow(k,e),hurwitzZeta(e,add(.5,l))),q=mul(pow(k,neg(e)),hurwitzZeta(e,sub(.5,l)));return mul(gamma(e),pow(2*pi,neg(e)),add(p,q))}if(isComplex(b)||isComplex(a)){for(var f=a,c=complex(1),d=2;Math.abs(c.re)>h||Math.abs(c.im)>h;)c=div(pow(a,d),pow(d,b)),f=add(f,c),d++;return f}for(var f=a,c=1,d=2;Math.abs(c)>h;)c=a**d/d**b,f+=c,d++;return f}function ode(f,b,[e,q],c=.001,x="runge-kutta"){if(q<e){var r=a=>a>=q;c*=-1}else var r=a=>a<=q;if(!Array.isArray(b)){var y=f;f=(a,b)=>[y(a,b)],b=[b]}if(isComplex(e)||isComplex(q)||b.some(a=>isComplex(a))||f(e,b).some(a=>isComplex(a))){if(isComplex(e)||(e=complex(e)),b.forEach((a,b,c)=>{isComplex(a)||(c[b]=complex(a))}),f(e,b).every(a=>!isComplex(a)))throw Error("All functions must handle complex math");var u=sub(q,e),v=abs(u);c=mul(c,div(u,v));var w=Math.trunc(v/abs(c)),o=0}var h=[[e].concat(b)],g=b.length;switch(x){case"euler":if(isComplex(e)){for(var d=add(e,c);o<w;d=add(d,c)){for(var s=f(d,b),a=0;a<g;a++)b[a]=add(b[a],mul(s[a],c));h.push([d].concat(b)),o++}return h}for(var d=e+c;r(d);d+=c){for(var s=f(d,b),a=0;a<g;a++)b[a]+=s[a]*c;h.push([d].concat(b))}return h;case"runge-kutta":if(isComplex(e)){for(var p=div(c,2),d=add(e,c);o<w;d=add(d,c)){for(var i=[],j=[],k=[],l=f(d,b),a=0;a<g;a++)i.push(add(b[a],mul(l[a],p)));for(var m=f(add(d,p),i),a=0;a<g;a++)j.push(add(b[a],mul(m[a],p)));for(var n=f(add(d,p),j),a=0;a<g;a++)k.push(add(b[a],mul(n[a],c)));for(var t=f(add(d,c),k),a=0;a<g;a++)b[a]=add(b[a],mul(add(l[a],mul(2,m[a]),mul(2,n[a]),t[a]),c,1/6));h.push([d].concat(b)),o++}return h}for(var d=e+c;r(d);d+=c){for(var i=[],j=[],k=[],l=f(d,b),a=0;a<g;a++)i.push(b[a]+l[a]*c/2);for(var m=f(d+c/2,i),a=0;a<g;a++)j.push(b[a]+m[a]*c/2);for(var n=f(d+c/2,j),a=0;a<g;a++)k.push(b[a]+n[a]*c);for(var t=f(d+c,k),a=0;a<g;a++)b[a]+=(l[a]+2*m[a]+2*n[a]+t[a])*c/6;h.push([d].concat(b))}return h;default:throw Error("Unsupported differential equation solver method")}}function diff(j,d,e=1,g="ridders"){if(isComplex(d)||isComplex(j(d))){if(!isComplex(j(d)))throw Error("Function must handle complex math");var f=abs(d),o=0===f?complex(1):div(d,f),p=diff(a=>j(mul(o,a)).re,f,e,g),q=diff(a=>j(mul(o,a)).im,f,e,g);return div(complex(p,q),o)}function h(){for(var b=0,a=0;a<=e;a++)b+=(-1)**a*binomial(e,a)*j(d+(e-2*a)*k);return b/(2*k)**e}switch(g){case"naive":var k=1e-8**(1/(e+2));return h();case"ridders":for(var l,k=1e-5**(1/(e+2)),i=Number.MAX_VALUE,m=10,b=[],a=0;a<m;a++)b.push([]);b[0][0]=h();for(var a=1;a<m;a++){k/=2,b[0][a]=h();for(var c=1;c<=a;c++){b[c][a]=(4**c*b[c-1][a]-b[c-1][a-1])/(4**c-1);var n=Math.max(Math.abs(b[c][a]-b[c-1][a]),Math.abs(b[c][a]-b[c-1][a-1]));n<=i&&(i=n,l=b[c][a])}if(Math.abs(b[a][a]-b[a-1][a-1])>i)break}return l;default:throw Error("Unsupported differentiation method")}}var D=diff;function taylorSeries(b,c,d=5){for(var e=[b(c)],a=1;a<d;a++)e.push(diff(b,c,a));return function(d){for(var b=0,a=0;a<e.length;a++)b=add(b,mul(e[a],pow(sub(d,c),a),1/factorial(a)));return b}}function gradient(d,a){if(d.length!==a.length)throw Error("Gradient point length differs from function");for(var c=[],b=0;b<a.length;b++){var e=a.slice();c.push(diff(a=>(e[b]=a,d.apply(null,e)),e[b]))}return c}function findExtremum(i,a,d={}){Array.isArray(a)||(a=[a]);for(var f,e,b,j=d.findMaximum?1:-1,g=("tolerance"in d)?d.tolerance:1e-10,k=.01*j,h=0;h<1e4;h++){f=gradient(i,a),b=!0;for(var c=0;c<a.length;c++)e=k*f[c],a[c]+=e,b=b&&e<g;if(b){if(1===a.length)return a[0];return a}}throw Error("No extremum found for tolerance "+g)}function integrate(e,[b,d],l={}){var K="method"in l?l.method:"adaptive-simpson",h="tolerance"in l?l.tolerance:1e-10;if(isComplex(b)||isComplex(d)||isComplex(e(b))){if(isComplex(b)||(b=complex(b)),!isComplex(e(b)))throw Error("Function must handle complex math");function P(a){return add(mul(sub(d,b),a),b)}var L=integrate(a=>e(P(a)).re,[0,1],l),M=integrate(a=>e(P(a)).im,[0,1],l);return mul(sub(d,b),complex(L,M))}function F(){for(var a=b+(i/=2);a<d;)m+=e(a),a+=2*i}switch(l.avoidEndpoints&&(b<d?(b+=h,d-=h):(b-=h,d+=h)),K){case"euler-maclaurin":for(var t=50,i=(d-b)/2,m=(e(b)+e(d))/2+e((b+d)/2),j=i*m,y=j,a=0;a<t;a++){if(F(),Math.abs((j=i*m)-y)<h*Math.abs(y))return j;y=j}throw Error("Maximum interations reached");case"romberg":for(var z=Number.MAX_VALUE,t=30,i=(d-b)/2,m=(e(b)+e(d))/2+e((b+d)/2),j=i*m,f=[],a=0;a<t;a++)f.push([]);f[0][0]=j;for(var a=1;a<t;a++){F(),f[0][a]=i*m;for(var c=1;c<=a;c++){f[c][a]=(4**c*f[c-1][a]-f[c-1][a-1])/(4**c-1);var u=Math.max(Math.abs(f[c][a]-f[c-1][a]),Math.abs(f[c][a]-f[c-1][a-1]));u<=z&&(z=u,j=f[c][a])}if(Math.abs(f[a][a]-f[a-1][a-1])>z)break}return j;case"adaptive-simpson":var t=50;function N(b,d,j,c,k,q,f,g){var a=d-b,h=e(b+a/4),i=e(d-a/4);if(isNaN(h)||isNaN(i))throw Error("NaN encountered in integration");var l=(j+4*h+c)*a/12,m=(c+4*i+k)*a/12,n=l+m,o=(n-q)/15;if(Math.abs(o)<f||g>t)return n+o;var p=b+a/2;return N(b,p,j,h,c,l,f/2,g+1)+N(p,d,c,i,k,m,f/2,g+1)}var G=e(b),H=e((b+d)/2),I=e(b),m=(G+4*H+I)*(d-b)/6;return N(b,d,G,H,I,m,h,0);case"tanh-sinh":for(var n=10,i=1/2**n,k=[],p=[],g=0;g<=20*2**n;g++){var B=g*i;if(k[g]=Math.tanh(Math.PI/2*Math.sinh(B)),p[g]=Math.PI/2*Math.cosh(B)/Math.cosh(Math.PI/2*Math.sinh(B))**2,Math.abs(1-k[g])<h)break}for(var O=g,q=0,o=(d-b)/2,r=(d+b)/2,g=1;g<=n;g++)for(var a=0;a<O;a+=2**(n-g))(a%2**(n-g+1)!=0||1===g)&&(0===a?q+=p[0]*e(r):q+=p[a]*(e(r-o*k[a])+e(r+o*k[a])));return o*i*q;case"gaussian":for(var n=10,k=[],p=[],v=3*2**n,c=1;c<=v/2;c++){for(var s=Math.cos(Math.PI*(c-.25)/(v+.5));;){for(var x=1,E=0,w=1;w<=v;w++)t3=E,x=((2*w-1)*s*(E=x)-(w-1)*t3)/w;var J=v*(s*x-E)/(s**2-1),u=x/J;if(s-=u,Math.abs(u)<h)break}k[c]=s,p[c]=2/(1-s**2)/J**2}for(var o=(d-b)/2,r=(d+b)/2,q=0,c=1;c<=v/2;c++)q+=p[c]*(e(r-o*k[c])+e(r+o*k[c]));return o*q;default:throw Error("Unsupported integration method")}}function discreteIntegral(a,d){for(var c=(a[0]+a[a.length-1])/2,b=1;b<a.length-1;b++)c+=a[b];return c*d}function summation(c,[d,e]){if(isComplex(c(d))){for(var b=complex(0),a=d;a<=e;a++)b=add(b,c(a));return b}for(var b=0,a=d;a<=e;a++)b+=c(a);return b}function polynomial(e,b,f=!1){for(var a=b[0],c=0,d=1;d<b.length;d++)f&&(c=add(a,mul(c,e))),a=add(b[d],mul(a,e));return f?{polynomial:a,derivative:c}:a}function partialBell(b,c,d){if(0===b&&0===c)return 1;if(0===b||0===c)return 0;for(var e=0,f=1,a=1;a<=b-c+1;a++)e+=f*d[a-1]*partialBell(b-a,c-1,d),f*=(b-a)/a;return e}function findRoot(b,f,g={}){var h="tolerance"in g?g.tolerance:1e-10;if(Array.isArray(b)){if(b.length!==f.length)throw Error("Mismatch between equations and starting point for root");for(var a=f,c=0;c<100;c++){for(var l=[],m=[],d=0;d<a.length;d++)l.push(gradient(b[d],a)),m.push(b[d].apply(null,a));for(var e=luSolve(l,m),d=0;d<a.length;d++)a[d]-=e[d];if(e.every(a=>Math.abs(a)<h))return a}throw Error("No root found for tolerance "+h)}Array.isArray(f)||g.method||(g.method="newton");var p="method"in g?g.method:"bisect";switch(p){case"bisect":var a,j,k=f[0],i=f[1],n=b(k);if(b(i),n*b(i)>=0)throw Error("Change of sign necessary for bisection");n<0?(a=k,j=i-k):(a=i,j=k-i);for(var c=0;c<100;c++){var o=a+(j/=2);if((fmid=b(o))<=0&&(a=o),0===fmid||Math.abs(j)<h)return a}throw Error("No root found for tolerance "+h);case"newton":var a=f;if(isComplex(b(a)))for(var c=0;c<100;c++){var e=div(b(a),diff(b,a));if(a=sub(a,e),abs(e)<h)return a}else for(var c=0;c<100;c++){var e=b(a)/diff(b,a);if(a-=e,Math.abs(e)<h)return a}throw Error("No root found for tolerance "+h);default:throw Error("Unsupported root finding method")}}function findRoots(a,b,c=1e-10){console.log("Renamed to findRoot")}function spline(f,i="function",l=1e-10){for(var d=[],j=[],c=[],k=[],a=0;a<f.length;a++)d[a]=f[a][1];c[0]=0,c[f.length-1]=0;var e=matrix(f.length-2),g=vector(f.length-2);function b(a){return f[a+1][0]-f[a][0]}for(var a=0;a<e.length;a++)e[a][a]=2*(b(a)+b(a+1)),g[a]=3*(d[a+2]-d[a+1])/b(a+1)-3*(d[a+1]-d[a])/b(a);for(var a=1;a<e.length;a++)e[a][a-1]=b(a),e[a-1][a]=b(a);for(var h=luSolve(e,g),a=0;a<h.length;a++)c[a+1]=h[a];for(var a=0;a<c.length-1;a++)j[a]=(d[a+1]-d[a])/b(a)-(c[a+1]+2*c[a])*b(a)/3,k[a]=(c[a+1]-c[a])/3/b(a);switch(i){case"function":return function(b){if(b<f[0][0]||b>f[f.length-1][0])throw Error("Argument outside spline input domain");for(var a=0;a<f.length;a++)if(b===f[a][0])return d[a];for(var a=0;a<f.length-1;a++)if(b>f[a][0]&&b<f[a+1][0]){var e=f[a][0];return d[a]+j[a]*(b-e)+c[a]*(b-e)**2+k[a]*(b-e)**3}};case"derivative":return function(b){if(b<f[0][0]||b>f[f.length-1][0])throw Error("Argument outside spline input domain");b===f[f.length-1][0]&&(b-=l);for(var a=0;a<f.length;a++)if(b===f[a][0])return j[a];for(var a=0;a<f.length-1;a++)if(b>f[a][0]&&b<f[a+1][0]){var d=f[a][0];return j[a]+2*c[a]*(b-d)+3*k[a]*(b-d)**2}};case"integral":return function(b){if(b<f[0][0]||b>f[f.length-1][0])throw Error("Argument outside spline input domain");var g=0;function e(b,a){var e=f[a][0];return d[a]*(b-e)+j[a]*(b-e)**2/2+c[a]*(b-e)**3/3+k[a]*(b-e)**4/4}for(var a=0;a<f.length-1;a++)if(b<f[a+1][0]){g+=e(b,a)-e(f[a][0],a);break}else g+=e(f[a+1][0],a)-e(f[a][0],a);return g};default:throw Error("Unsupported spline value")}}function fourierSinCoefficient(a,c,g){if(!Number.isInteger(c))throw Error("Nonintegral Fourier index");if(0===c)return 0;if("function"==typeof a){var e=g||2*pi;return 2/e*integrate(b=>a(b)*sin(2*c*pi/e*b),[0,e],{method:"tanh-sinh"})}if(Array.isArray(a)){for(var f=0,d=a.length,b=0;b<d;b++)f+=a[b][1]*sin(2*c*pi*b/d);return 2*f/d}throw Error("Unsupported Fourier input")}function fourierCosCoefficient(b,d,g){if(!Number.isInteger(d))throw Error("Nonintegral Fourier index");if("function"==typeof b){var e=g||2*pi;return 0===d?1/e*integrate(a=>b(a),[0,e],{method:"tanh-sinh"}):2/e*integrate(a=>b(a)*cos(2*d*pi/e*a),[0,e],{method:"tanh-sinh"})}if(Array.isArray(b)){var f=0,c=b.length;if(0===d){for(var a=0;a<c;a++)f+=b[a][1];return f/c}for(var a=0;a<c;a++)f+=b[a][1]*cos(2*d*pi*a/c);return 2*f/c}throw Error("Unsupported Fourier input")}function eigensystem(a,b=!0){if(b)return tridiagonalQL(tridiagonalForm(a));throw Error("Unsupported eigensystem")}function tridiagonalForm(l){for(var f=l.length,d=[],b=0;b<f;b++)d[b]=l[b].slice();for(var e=vector(f),g=vector(f),a=0;a<f;a++)e[a]=d[f-1][a];for(var b=f-1;b>0;b--){for(var k=0,j=0,c=0;c<b;c++)k+=Math.abs(e[c]);if(0===k){g[b]=e[b-1];for(var a=0;a<b;a++)e[a]=d[b-1][a],d[b][a]=0,d[a][b]=0}else{for(var c=0;c<b;c++)e[c]/=k,j+=e[c]*e[c];var i=e[b-1],h=Math.sqrt(j);i>0&&(h=-h),g[b]=k*h,j-=i*h,e[b-1]=i-h;for(var a=0;a<b;a++)g[a]=0;for(var a=0;a<b;a++){i=e[a],d[a][b]=i,h=g[a]+d[a][a]*i;for(var c=a+1;c<=b-1;c++)h+=d[c][a]*e[c],g[c]+=d[c][a]*i;g[a]=h}i=0;for(var a=0;a<b;a++)g[a]/=j,i+=g[a]*e[a];for(var m=i/(j+j),a=0;a<b;a++)g[a]-=m*e[a];for(var a=0;a<b;a++){i=e[a],h=g[a];for(var c=a;c<=b-1;c++)d[c][a]-=i*g[c]+h*e[c];e[a]=d[b-1][a],d[b][a]=0}}e[b]=j}for(var b=0;b<f-1;b++){d[f-1][b]=d[b][b],d[b][b]=1;var j=e[b+1];if(0!==j){for(var c=0;c<=b;c++)e[c]=d[c][b+1]/j;for(var a=0;a<=b;a++){for(var h=0,c=0;c<=b;c++)h+=d[c][b+1]*d[c][a];for(var c=0;c<=b;c++)d[c][a]-=h*e[c]}}for(var c=0;c<=b;c++)d[c][b+1]=0}for(var a=0;a<f;a++)e[a]=d[f-1][a],d[f-1][a]=0;return d[f-1][f-1]=1,g[0]=0,{diagonal:e,offDiagonal:g,eigenvectors:d}}function tridiagonalQL(q){var c=q.diagonal,k=c.length,e=q.offDiagonal,i=q.eigenvectors;function r(c,b){var a;return Math.abs(c)>Math.abs(b)?(a=b/c,a=Math.abs(c)*Math.sqrt(1+a*a)):0!=b?(a=c/b,a=Math.abs(b)*Math.sqrt(1+a*a)):a=0,a}for(var a=1;a<k;a++)e[a-1]=e[a];e[k-1]=0;for(var s=0,p=0,b=0;b<k;b++){p=Math.max(p,Math.abs(c[b])+Math.abs(e[b]));for(var n=b;n<k&&!(Math.abs(e[n])<=2220446049250313e-31*p);)n++;if(n>b){var w=0;do{if((w+=1)>1e3)throw Error("Eigenvalues not converging...");var o=c[b],d=(c[b+1]-o)/(2*e[b]),l=r(d,1);d<0&&(l=-l),c[b]=e[b]/(d+l),c[b+1]=e[b]*(d+l);for(var x=c[b+1],m=o-c[b],a=b+2;a<k;a++)c[a]-=m;s+=m,d=c[n];for(var h=1,t=h,u=h,y=e[b+1],j=0,v=0,a=n-1;a>=b;a--){u=t,t=h,v=j,o=h*e[a],m=h*d,l=r(d,e[a]),e[a+1]=j*l,j=e[a]/l,h=d/l,d=h*c[a]-j*o,c[a+1]=m+j*(h*o+j*c[a]);for(var f=0;f<k;f++)m=i[f][a+1],i[f][a+1]=j*i[f][a]+h*m,i[f][a]=h*i[f][a]-j*m}d=-j*v*u*y*e[b]/x,e[b]=j*d,c[b]=h*d}while(Math.abs(e[b])>2220446049250313e-31*p)}c[b]=c[b]+s,e[b]=0}for(var a=0;a<k-1;a++){for(var f=a,d=c[a],g=a+1;g<k;g++)c[g]<d&&(f=g,d=c[g]);if(f!=a){c[f]=c[a],c[a]=d;for(var g=0;g<k;g++)d=i[g][a],i[g][a]=i[g][f],i[g][f]=d}}return{eigenvalues:c,eigenvectors:i}}function hessenbergForm(a){}function luDecomposition(j,n=1e-10){for(var d=j.length,c=[],a=0;a<d;a++)c[a]=j[a].slice();var f=identity(d);pivots=0;for(var a=0;a<d;a++){for(var h=0,e=a,b=a;b<d;b++){var k=Math.abs(c[b][a]);k>h&&(h=k,e=b)}if(h<n)throw Error("Matrix is degenerate");if(e!==a){var i=c[a];c[a]=c[e],c[e]=i;var i=f[a];f[a]=f[e],f[e]=i,pivots++}for(var b=a+1;b<d;b++){c[b][a]/=c[a][a];for(var g=a+1;g<d;g++)c[b][g]-=c[b][a]*c[a][g]}}for(var l=identity(d),a=1;a<d;a++)for(var b=0;b<a;b++)l[a][b]=c[a][b];for(var m=matrix(d),a=0;a<d;a++)for(var b=a;b<d;b++)m[a][b]=c[a][b];return{L:l,U:m,P:f,pivots:pivots}}function luSolve(g,i){for(var c=g.length,d=luDecomposition(g),e=vector(c),f=vector(c),h=vector(c),a=0;a<c;a++)for(var b=0;b<c;b++)h[a]+=d.P[a][b]*i[b];for(var a=0;a<c;a++){f[a]=h[a];for(var b=0;b<a;b++)f[a]-=d.L[a][b]*f[b];f[a]/=d.L[a][a]}for(var a=c-1;a>=0;a--){e[a]=f[a];for(var b=a+1;b<c;b++)e[a]-=d.U[a][b]*e[b];e[a]/=d.U[a][a]}return e}function determinant(b){for(var c=luDecomposition(b),d=1,a=0;a<b.length;a++)d*=c.U[a][a];return(-1)**c.pivots*d}function inverse(a){for(var d=matrix(a.length),b=0;b<a.length;b++){var e=vector(a.length);e[b]=1;for(var f=luSolve(a,e),c=0;c<a.length;c++)d[c][b]=f[c]}return d}function vector(c,d=0){for(var a=[],b=0;b<c;b++)a.push(d);return a}function matrix(d,a,f=0){for(var a=a||d,b=[],c=0;c<d;c++){b.push([]);for(var e=0;e<a;e++)b[c].push(f)}return b}function identity(b,d=1){for(var c=matrix(b),a=0;a<b;a++)c[a][a]=d;return c}function transpose(a){for(var d=matrix(a[0].length,a.length),b=0;b<a.length;b++)for(var c=0;c<a[0].length;c++)d[c][b]=a[b][c];return d}function matrixAdd(a,b){if(!Array.isArray(a)&&!Array.isArray(b))throw Error("No matrices to add");Array.isArray(a)||(a=matrix(b.length,b[0].length,a)),Array.isArray(b)||(b=matrix(a.length,a[0].length,b));for(var e=matrix(a.length,a[0].length,0),c=0;c<a.length;c++)for(var d=0;d<a[0].length;d++)e[c][d]=add(a[c][d],b[c][d]);return e}function matrixSub(a,b){if(!Array.isArray(a)&&!Array.isArray(b))throw Error("No matrices to subtract");Array.isArray(a)||(a=matrix(b.length,b[0].length,a)),Array.isArray(b)||(b=matrix(a.length,a[0].length,b));for(var e=matrix(a.length,a[0].length,0),c=0;c<a.length;c++)for(var d=0;d<a[0].length;d++)e[c][d]=sub(a[c][d],b[c][d]);return e}function matrixMul(a,b){if(!Array.isArray(a)&&!Array.isArray(b))throw Error("No matrices to multiply");if(Array.isArray(a)||(a=identity(b.length,a)),Array.isArray(b)||(b=identity(a[0].length,b)),a[0].length!==b.length)throw Error("Incompatible matrices to multiply");for(var f=matrix(a.length,b[0].length,0),c=0;c<a.length;c++)for(var d=0;d<b[0].length;d++)for(var e=0;e<a[0].length;e++)f[c][d]=add(f[c][d],mul(a[c][e],b[e][d]));return f}